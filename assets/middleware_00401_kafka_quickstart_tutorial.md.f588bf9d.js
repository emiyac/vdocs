import{_ as s,o as n,c as a,Q as l}from"./chunks/framework.eabe3503.js";const F=JSON.parse('{"title":"kafka快速部署和使用","description":"","frontmatter":{"title":"kafka快速部署和使用","createTime":"2024-03-17T10:00:00.000Z","updateTime":"2024-03-17T23:09:10.000Z","isPublished":true,"tags":["docker-compose","kafka"]},"headers":[],"relativePath":"middleware/00401_kafka_quickstart_tutorial.md","filePath":"middleware/00401_kafka_quickstart_tutorial.md"}'),p={name:"middleware/00401_kafka_quickstart_tutorial.md"},o=l(`<p>本次示例使用<code>docker-compose</code>来快速部署<code>kafka</code>单节点和集群环境，并展示了常用的命令行和一些常见的问题</p><h2 id="docker-compose部署kafka单节点" tabindex="-1">docker-compose部署kafka单节点 <a class="header-anchor" href="#docker-compose部署kafka单节点" aria-label="Permalink to &quot;docker-compose部署kafka单节点&quot;">​</a></h2><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>⚡ 仅用于测试环境</p></div><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F07178;">version</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">3</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#F07178;">services</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">zookeeper</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">hostname</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">zookeeper</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">zookeeper:3.5.5</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">container_name</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">zookeeper</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">volumes</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">./data/zookeeper:/data</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/etc/localtime:/etc/localtime:ro</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">ports</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2181:2181</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">logging</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#F07178;">driver</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">json-file</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#F07178;">options</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#F07178;">max-size</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">100m</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#F07178;">max-file</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">3</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">restart</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">on-failure</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">networks</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">kafka</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">kafka</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">hostname</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">kafka</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">bitnami/kafka:3.0.0</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">container_name</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">kafka</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">user</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">root</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">volumes</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">./data/kafka:/bitnami/kafka/data</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/etc/localtime:/etc/localtime:ro</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">ports</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">9092:9092</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">environment</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">KAFKA_CFG_BROKER_ID=0</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">ALLOW_PLAINTEXT_LISTENER=yes</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">KAFKA_CFG_LISTENERS=PLAINTEXT://0.0.0.0:9092</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">KAFKA_CFG_ADVERTISED_LISTENERS=PLAINTEXT://192.168.10.11:9092</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">logging</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#F07178;">driver</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">json-file</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#F07178;">options</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#F07178;">max-size</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">100m</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#F07178;">max-file</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">3</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">depends_on</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">zookeeper</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">restart</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">on-failure</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">networks</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">kafka</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">kafka-map</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">hostname</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">kafka-map</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">dushixiang/kafka-map:latest</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">container_name</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">kafka-map</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">volumes</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">./data/kafka-map:/usr/local/kafka-map/data</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">environment</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">DEFAULT_USERNAME=admin</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">DEFAULT_PASSWORD=admin123</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">ports</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;">                              </span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">8080:8080</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">depends_on</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;">                  </span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">zookeeper</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">kafka</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">restart</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">on-failure</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">networks</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">kafka</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">networks</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">kafka</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">driver</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">bridge</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">ipam</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#F07178;">config</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#F07178;">subnet</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">172.40.0.0/16</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br></div></div><h2 id="docker-compose部署kafka集群" tabindex="-1">docker-compose部署kafka集群 <a class="header-anchor" href="#docker-compose部署kafka集群" aria-label="Permalink to &quot;docker-compose部署kafka集群&quot;">​</a></h2><p>step01 创建相关目录</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">mkdir</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">data/zookeeper0{</span><span style="color:#F78C6C;">1</span><span style="color:#C3E88D;">..3}</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">data/kafka0{</span><span style="color:#F78C6C;">1</span><span style="color:#C3E88D;">..2}</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">data/kafka-map</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>step02 创建<code>zookeeper</code>集群配置文件</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">cat</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">data/zoo.cfg</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&lt;&lt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">EOF</span></span>
<span class="line"><span style="color:#C3E88D;"># 数据目录</span></span>
<span class="line"><span style="color:#C3E88D;">dataDir=/data</span></span>
<span class="line"><span style="color:#C3E88D;">dataLogDir=/datalog</span></span>
<span class="line"><span style="color:#C3E88D;"># 心跳时间</span></span>
<span class="line"><span style="color:#C3E88D;">tickTime=2000</span></span>
<span class="line"><span style="color:#C3E88D;"># 客户端端口</span></span>
<span class="line"><span style="color:#C3E88D;">clientPort=2181</span></span>
<span class="line"><span style="color:#C3E88D;"># follow和leader之间初始连接时能容忍的最多心跳数</span></span>
<span class="line"><span style="color:#C3E88D;">initLimit=5</span></span>
<span class="line"><span style="color:#C3E88D;"># follow和leader之间请求和应答时能容忍的最多心跳数</span></span>
<span class="line"><span style="color:#C3E88D;">syncLimit=2</span></span>
<span class="line"><span style="color:#C3E88D;"># 保存快照的数量和定时清理快照的时间</span></span>
<span class="line"><span style="color:#C3E88D;">autopurge.snapRetainCount=3</span></span>
<span class="line"><span style="color:#C3E88D;">autopurge.purgeInterval=1</span></span>
<span class="line"><span style="color:#C3E88D;"># 最大的客户端连接数</span></span>
<span class="line"><span style="color:#C3E88D;">maxClientCnxns=60</span></span>
<span class="line"><span style="color:#C3E88D;"># standaloneEnabled=true</span></span>
<span class="line"><span style="color:#C3E88D;"># admin.enableServer=true</span></span>
<span class="line"><span style="color:#C3E88D;"># 集群配置,2888主从通信端口,3888用来选举leader</span></span>
<span class="line"><span style="color:#C3E88D;">server.1=zookeeper01:2888:3888;2181</span></span>
<span class="line"><span style="color:#C3E88D;">server.2=zookeeper02:2888:3888;2181</span></span>
<span class="line"><span style="color:#C3E88D;">server.3=zookeeper03:2888:3888;2181</span></span>
<span class="line"><span style="color:#89DDFF;">EOF</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>step03 给<code>zookeeper</code>集群分配节点id</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#BABED8;"> i </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#FFCB6B;">seq</span><span style="color:#C3E88D;"> </span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;">\`</span><span style="color:#89DDFF;">;</span><span style="color:#89DDFF;font-style:italic;">do</span><span style="color:#BABED8;"> echo $i </span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;"> data/zookeeper0$i/myid </span><span style="color:#89DDFF;">;</span><span style="color:#89DDFF;font-style:italic;">done</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>step04 编辑编排文件并启动容器</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F07178;">version</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">3</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#F07178;">services</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">zookeeper01</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">hostname</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">zookeeper01</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">zookeeper:3.5.5</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">container_name</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">zookeeper01</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">volumes</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">./data/zookeeper01:/data</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">./data/zoo.cfg:/conf/zoo.cfg</span><span style="color:#BABED8;">   </span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/etc/localtime:/etc/localtime:ro</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">ports</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2181:2181</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">logging</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#F07178;">driver</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">json-file</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#F07178;">options</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#F07178;">max-size</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">100m</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#F07178;">max-file</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">3</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">restart</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">on-failure</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">networks</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">kafka</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">zookeeper02</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">hostname</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">zookeeper02</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">zookeeper:3.5.5</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">container_name</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">zookeeper02</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">volumes</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">./data/zookeeper02:/data</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">./data/zoo.cfg:/conf/zoo.cfg</span><span style="color:#BABED8;">   </span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/etc/localtime:/etc/localtime:ro</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">ports</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2182:2181</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">logging</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#F07178;">driver</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">json-file</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#F07178;">options</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#F07178;">max-size</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">100m</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#F07178;">max-file</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">3</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">restart</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">on-failure</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">depends_on</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">zookeeper01</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">networks</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">kafka</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">zookeeper03</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">hostname</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">zookeeper03</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">zookeeper:3.5.5</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">container_name</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">zookeeper03</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">volumes</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">./data/zookeeper03:/data</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">./data/zoo.cfg:/conf/zoo.cfg</span><span style="color:#BABED8;">   </span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/etc/localtime:/etc/localtime:ro</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">ports</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2183:2181</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">logging</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#F07178;">driver</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">json-file</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#F07178;">options</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#F07178;">max-size</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">100m</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#F07178;">max-file</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">3</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">restart</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">on-failure</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">depends_on</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">zookeeper01</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">zookeeper02</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">networks</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">kafka</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">kafka01</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">hostname</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">kafka01</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">bitnami/kafka:3.0.0</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">container_name</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">kafka01</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">user</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">root</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">volumes</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">./data/kafka01:/bitnami/kafka/data</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/etc/localtime:/etc/localtime:ro</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">ports</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">9093:9093</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">environment</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">KAFKA_CFG_BROKER_ID=1</span><span style="color:#BABED8;"> </span><span style="color:#676E95;font-style:italic;"># broker id全局唯一</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">ALLOW_PLAINTEXT_LISTENER=yes</span><span style="color:#BABED8;"> </span><span style="color:#676E95;font-style:italic;">#允许使用PLAINTEXT监听器</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">KAFKA_CFG_INTER_BROKER_LISTENER_NAME=INTERNAL</span><span style="color:#BABED8;"> </span><span style="color:#676E95;font-style:italic;"># 用于配置broker之间通信使用的监听器名称</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">KAFKA_CFG_LISTENER_SECURITY_PROTOCOL_MAP=INTERNAL:PLAINTEXT,EXTERNAL:PLAINTEXT</span><span style="color:#BABED8;"> </span><span style="color:#676E95;font-style:italic;"># 监听的协议集合多个,这里INTERNAL指的是内部,EXTERNAL是外部</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">KAFKA_CFG_LISTENERS=INTERNAL://0.0.0.0:9092,EXTERNAL://0.0.0.0:9093</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">KAFKA_CFG_ADVERTISED_LISTENERS=INTERNAL://kafka01:9092,EXTERNAL://192.168.10.11:9093</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">KAFKA_CFG_ZOOKEEPER_CONNECT=zookeeper01:2181,zookeeper02:2181,zookeeper03:2181</span><span style="color:#BABED8;"> </span><span style="color:#676E95;font-style:italic;"># zookeeper集群地址</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">logging</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#F07178;">driver</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">json-file</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#F07178;">options</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#F07178;">max-size</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">100m</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#F07178;">max-file</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">3</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">depends_on</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">zookeeper03</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">restart</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">on-failure</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">networks</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">kafka</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">kafka02</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">hostname</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">kafka02</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">bitnami/kafka:3.0.0</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">container_name</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">kafka02</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">user</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">root</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">volumes</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">./data/kafka02:/bitnami/kafka/data</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/etc/localtime:/etc/localtime:ro</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">ports</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">9094:9094</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">environment</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">KAFKA_CFG_BROKER_ID=2</span><span style="color:#BABED8;"> </span><span style="color:#676E95;font-style:italic;"># broker id全局唯一</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">ALLOW_PLAINTEXT_LISTENER=yes</span><span style="color:#BABED8;"> </span><span style="color:#676E95;font-style:italic;">#允许使用PLAINTEXT监听器</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">KAFKA_CFG_INTER_BROKER_LISTENER_NAME=INTERNAL</span><span style="color:#BABED8;"> </span><span style="color:#676E95;font-style:italic;"># 用于配置broker之间通信使用的监听器名称</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">KAFKA_CFG_LISTENER_SECURITY_PROTOCOL_MAP=INTERNAL:PLAINTEXT,EXTERNAL:PLAINTEXT</span><span style="color:#BABED8;"> </span><span style="color:#676E95;font-style:italic;"># 监听的协议集合多个,这里INTERNAL指的是内部,EXTERNAL是外部</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">KAFKA_CFG_LISTENERS=INTERNAL://0.0.0.0:9092,EXTERNAL://0.0.0.0:9094</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">KAFKA_CFG_ADVERTISED_LISTENERS=INTERNAL://kafka02:9092,EXTERNAL://192.168.10.11:9094</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">KAFKA_CFG_ZOOKEEPER_CONNECT=zookeeper01:2181,zookeeper02:2181,zookeeper03:2181</span><span style="color:#BABED8;"> </span><span style="color:#676E95;font-style:italic;"># zookeeper集群地址</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">logging</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#F07178;">driver</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">json-file</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#F07178;">options</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#F07178;">max-size</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">100m</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#F07178;">max-file</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">3</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">depends_on</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">zookeeper03</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">restart</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">on-failure</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">networks</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">kafka</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">kafka-map</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">hostname</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">kafka-map</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">dushixiang/kafka-map:latest</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">container_name</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">kafka-map</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">volumes</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">./data/kafka-map:/usr/local/kafka-map/data</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">ports</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;">                              </span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">8080:8080</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">environment</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">DEFAULT_USERNAME=admin</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">DEFAULT_PASSWORD=admin123</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">logging</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#F07178;">driver</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">json-file</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#F07178;">options</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#F07178;">max-size</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">100m</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#F07178;">max-file</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">3</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">restart</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">on-failure</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">networks</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">kafka</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">networks</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">kafka</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">driver</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">bridge</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">ipam</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#F07178;">config</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#F07178;">subnet</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">172.40.0.0/16</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br></div></div><h2 id="相关命令行" tabindex="-1">相关命令行 <a class="header-anchor" href="#相关命令行" aria-label="Permalink to &quot;相关命令行&quot;">​</a></h2><h3 id="检查zookeeper集群状态" tabindex="-1">检查zookeeper集群状态 <a class="header-anchor" href="#检查zookeeper集群状态" aria-label="Permalink to &quot;检查zookeeper集群状态&quot;">​</a></h3><p>查看<code>zookeeper</code>集群状态，其中<code>Mode: follower</code>为从节点，<code>Mode: leader</code>为选举的主节点</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">exec</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-it</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">zookeeper01</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">./bin/zkServer.sh</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">status</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>登录<code>zookeeper</code>客户端查看<code>zookeeper</code>集群信息</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">ls</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/zookeeper</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># [config, quota]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">get</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/zookeeper/config</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># server.1=zookeeper01:2888:3888:participant;0.0.0.0:2181</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># server.2=zookeeper02:2888:3888:participant;0.0.0.0:2181</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># server.3=zookeeper03:2888:3888:participant;0.0.0.0:2181</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># version=0</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="查看broker注册信息" tabindex="-1">查看broker注册信息 <a class="header-anchor" href="#查看broker注册信息" aria-label="Permalink to &quot;查看broker注册信息&quot;">​</a></h3><p>登录<code>zookeeper</code>客户端查看<code>kafka broker</code>注册信息</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">ls</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/brokers/ids</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># [1, 2]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">get</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/brokers/ids/1</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># {&quot;listener_security_protocol_map&quot;:{&quot;INTERNAL&quot;:&quot;PLAINTEXT&quot;,&quot;EXTERNAL&quot;:&quot;PLAINTEXT&quot;},&quot;endpoints&quot;:[&quot;INTERNAL://kafka01:9092&quot;,&quot;EXTERNAL://192.168.10.11:9093&quot;],&quot;jmx_port&quot;:-1,&quot;features&quot;:{},&quot;host&quot;:&quot;kafka01&quot;,&quot;timestamp&quot;:&quot;1710782861074&quot;,&quot;port&quot;:9092,&quot;version&quot;:5}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">get</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/brokers/ids/2</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># {&quot;listener_security_protocol_map&quot;:{&quot;INTERNAL&quot;:&quot;PLAINTEXT&quot;,&quot;EXTERNAL&quot;:&quot;PLAINTEXT&quot;},&quot;endpoints&quot;:[&quot;INTERNAL://kafka02:9092&quot;,&quot;EXTERNAL://192.168.10.11:9094&quot;],&quot;jmx_port&quot;:-1,&quot;features&quot;:{},&quot;host&quot;:&quot;kafka02&quot;,&quot;timestamp&quot;:&quot;1710782890247&quot;,&quot;port&quot;:9092,&quot;version&quot;:5}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="topic管理" tabindex="-1">topic管理 <a class="header-anchor" href="#topic管理" aria-label="Permalink to &quot;topic管理&quot;">​</a></h3><p>创建<code>topic</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">./bin/kafka-topics.sh</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--bootstrap-server</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">localhost:9092</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--create</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--topic</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">topic01</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--partitions</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">2</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--replication-factor=2</span><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Created topic topic01.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>查看所有<code>topic</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">./bin/kafka-topics.sh</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--bootstrap-server</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">localhost:9092</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--list</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># __consumer_offsets</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># topic01</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>查看指定的<code>topic</code>信息</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">./bin/kafka-topics.sh</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--bootstrap-server</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">localhost:9092</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--describe</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--topic</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">topic01</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Topic: topic01	TopicId: cjNJWFhGQjaLkqTryTr4Og	PartitionCount: 2	ReplicationFactor: 2	Configs: segment.bytes=1073741824</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 	Topic: topic01	Partition: 0	Leader: 1	Replicas: 1,2	Isr: 1,2</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 	Topic: topic01	Partition: 1	Leader: 2	Replicas: 2,1	Isr: 2,1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="生产消费测试" tabindex="-1">生产消费测试 <a class="header-anchor" href="#生产消费测试" aria-label="Permalink to &quot;生产消费测试&quot;">​</a></h3><p>生产消息</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">./kafka-console-producer.sh</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--bootstrap-server</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">localhost:9092</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--topic</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">topic01</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># &gt;task01</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># &gt;task02</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># &gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>消费消息</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">./kafka-console-consumer.sh</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--bootstrap-server</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">localhost:9092</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--topic</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">topic01</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># task01</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># task02</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="遇到的问题" tabindex="-1">遇到的问题 <a class="header-anchor" href="#遇到的问题" aria-label="Permalink to &quot;遇到的问题&quot;">​</a></h2><h3 id="zookeeper服务启动失败" tabindex="-1">zookeeper服务启动失败 <a class="header-anchor" href="#zookeeper服务启动失败" aria-label="Permalink to &quot;zookeeper服务启动失败&quot;">​</a></h3><p>查看服务状态</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">exec</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-it</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">zookeeper01</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">./bin/zkServer.sh</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">status</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># ZooKeeper JMX enabled by default</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Using config: /conf/zoo.cfg</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Client port found: 2181. Client address: localhost.</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Error contacting service. It is probably not running.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>日志显示</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">myid:1</span><span style="color:#89DDFF;">]</span><span style="color:#BABED8;"> - WARN  </span><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">NIOWorkerThread-1:NIOServerCnxn@370</span><span style="color:#89DDFF;">]</span><span style="color:#BABED8;"> - Exception causing close of session 0x0: ZooKeeperServer not running</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">myid:1</span><span style="color:#89DDFF;">]</span><span style="color:#BABED8;"> - INFO  </span><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">QuorumPeer</span><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">myid</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">]</span><span style="color:#BABED8;">(plain</span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;">/0.0.0.0:2181)(secure</span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;">disabled):QuorumCnxManager@430</span><span style="color:#89DDFF;">]</span><span style="color:#BABED8;"> - Have smaller server identifier, so dropping the connection: </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">2,</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">myid:1</span><span style="color:#89DDFF;">]</span><span style="color:#BABED8;"> - INFO  </span><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">QuorumPeer</span><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">myid</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">]</span><span style="color:#BABED8;">(plain</span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;">/0.0.0.0:2181)(secure</span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;">disabled):QuorumCnxManager@430</span><span style="color:#89DDFF;">]</span><span style="color:#BABED8;"> - Have smaller server identifier, so dropping the connection: </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">3,</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>zookeeper</code>集群在启动时需要按照<code>myid</code>从小到大的顺序来启动</p><h3 id="kafka启动失败" tabindex="-1">kafka启动失败 <a class="header-anchor" href="#kafka启动失败" aria-label="Permalink to &quot;kafka启动失败&quot;">​</a></h3><p>日志显示</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">ERROR</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">Fatal</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">error</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">during</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">KafkaServer</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">startup.</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">Prepare</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">to</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">shutdown</span><span style="color:#BABED8;"> (kafka.server.KafkaServer)</span></span>
<span class="line"><span style="color:#FFCB6B;">kafka.common.InconsistentClusterIdException:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">The</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">Cluster</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">ID</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">CbqG-ZOgTWKPFsdZinWJug</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">doesn</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">t match stored clusterId Some(lTfRgejGQ_ipngoCuI9RnQ) in meta.properties. The broker is trying to join the wrong cluster. Configured zookeeper.connect may be wrong.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>是由于<code>kafka</code>当前的<code>cluster.id</code>与<code>meta.properties</code>文件中记录的<code>cluster.id</code>不一致导致的，需要删除<code>meta.properties</code>文件后重新启动<code>kafka</code>服务</p>`,45),e=[o];function r(c,t,D,y,i,B){return n(),a("div",null,e)}const b=s(p,[["render",r]]);export{F as __pageData,b as default};
