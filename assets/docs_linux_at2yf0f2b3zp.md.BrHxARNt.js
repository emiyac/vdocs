import{_ as a,a as n,o as l,a3 as p}from"./chunks/framework.dRMRuUHH.js";const y=JSON.parse('{"title":"lvm逻辑卷管理","description":"","frontmatter":{"id":1004,"title":"lvm逻辑卷管理","createTime":"2024-05-13 21:00:00","category":"linux"},"headers":[],"relativePath":"docs/linux/at2yf0f2b3zp.md","filePath":"docs/linux/00401_lvm.md"}'),e={name:"docs/linux/at2yf0f2b3zp.md"};function o(r,s,c,t,i,d){return l(),n("div",null,[...s[0]||(s[0]=[p(`<h2 id="lvm逻辑卷管理" tabindex="-1">lvm逻辑卷管理 <a class="header-anchor" href="#lvm逻辑卷管理" aria-label="Permalink to “lvm逻辑卷管理”">​</a></h2><blockquote><p>LVM（Logical Volume Manager）是一种基于Linux的磁盘管理工具，它允许你创建、调整和删除逻辑卷。LVM将物理磁盘分成逻辑块，然后对这些逻辑块进行管理。这样，你可以将不同物理磁盘上的数据组合成单个逻辑卷，从而提供更大的存储空间。LVM还可以实现数据冗余和多路径存储，从而提高数据安全性</p></blockquote><h3 id="lvm的组成" tabindex="-1">lvm的组成 <a class="header-anchor" href="#lvm的组成" aria-label="Permalink to “lvm的组成”">​</a></h3><ul><li>PV（Physical Volume）：物理卷是物理磁盘的分区或整块磁盘，它是LVM的基本存储单元。</li><li>VG（Volume Group）：卷组是由一个或多个物理卷组成的存储池，可以包含多个逻辑卷。</li><li>LV（Logical Volume）：逻辑卷是LVM的逻辑存储单元，它可以是固定大小的或可调整大小的。</li><li>PE（Physical Extent）：物理扩展是LVM的逻辑存储单元，它是LVM的基本存储单元。</li></ul><h3 id="准备工作" tabindex="-1">准备工作 <a class="header-anchor" href="#准备工作" aria-label="Permalink to “准备工作”">​</a></h3><p>如下所示：有两块磁盘<code>/dev/sdb</code>和<code>/dev/sdc</code>,其中<code>/dev/sdb</code>用来创建逻辑卷并且格式化后挂载到<code>/data1</code>和<code>/data2</code>目录，<code>/dev/sdc</code>用于扩容这两个目录</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#A6E22E;">lsblk</span></span>
<span class="line"><span style="color:#A6E22E;">NAME</span><span style="color:#E6DB74;">            MAJ:MIN</span><span style="color:#E6DB74;"> RM</span><span style="color:#E6DB74;">  SIZE</span><span style="color:#E6DB74;"> RO</span><span style="color:#E6DB74;"> TYPE</span><span style="color:#E6DB74;"> MOUNTPOINT</span></span>
<span class="line"><span style="color:#A6E22E;">sda</span><span style="color:#E6DB74;">               8:0</span><span style="color:#AE81FF;">    0</span><span style="color:#E6DB74;">   20G</span><span style="color:#AE81FF;">  0</span><span style="color:#E6DB74;"> disk</span><span style="color:#F8F8F2;"> </span></span>
<span class="line"><span style="color:#A6E22E;">├─sda1</span><span style="color:#E6DB74;">            8:1</span><span style="color:#AE81FF;">    0</span><span style="color:#E6DB74;">    1G</span><span style="color:#AE81FF;">  0</span><span style="color:#E6DB74;"> part</span><span style="color:#E6DB74;"> /boot</span></span>
<span class="line"><span style="color:#A6E22E;">└─sda2</span><span style="color:#E6DB74;">            8:2</span><span style="color:#AE81FF;">    0</span><span style="color:#E6DB74;">   19G</span><span style="color:#AE81FF;">  0</span><span style="color:#E6DB74;"> part</span><span style="color:#F8F8F2;"> </span></span>
<span class="line"><span style="color:#A6E22E;">  ├─centos-root</span><span style="color:#E6DB74;"> 253:0</span><span style="color:#AE81FF;">    0</span><span style="color:#E6DB74;">   17G</span><span style="color:#AE81FF;">  0</span><span style="color:#E6DB74;"> lvm</span><span style="color:#E6DB74;">  /</span></span>
<span class="line"><span style="color:#A6E22E;">  └─centos-swap</span><span style="color:#E6DB74;"> 253:1</span><span style="color:#AE81FF;">    0</span><span style="color:#E6DB74;">    2G</span><span style="color:#AE81FF;">  0</span><span style="color:#E6DB74;"> lvm</span><span style="color:#F8F8F2;">  [SWAP]</span></span>
<span class="line highlighted"><span style="color:#A6E22E;">sdb</span><span style="color:#E6DB74;">               8:16</span><span style="color:#AE81FF;">   0</span><span style="color:#E6DB74;">   10G</span><span style="color:#AE81FF;">  0</span><span style="color:#E6DB74;"> disk</span><span style="color:#F8F8F2;"> </span></span>
<span class="line highlighted"><span style="color:#A6E22E;">sdc</span><span style="color:#E6DB74;">               8:32</span><span style="color:#AE81FF;">   0</span><span style="color:#E6DB74;">   10G</span><span style="color:#AE81FF;">  0</span><span style="color:#E6DB74;"> disk</span><span style="color:#F8F8F2;"> </span></span>
<span class="line"><span style="color:#A6E22E;">sr0</span><span style="color:#E6DB74;">              11:0</span><span style="color:#AE81FF;">    1</span><span style="color:#E6DB74;"> 1024M</span><span style="color:#AE81FF;">  0</span><span style="color:#E6DB74;"> rom</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="lvm的创建" tabindex="-1">lvm的创建 <a class="header-anchor" href="#lvm的创建" aria-label="Permalink to “lvm的创建”">​</a></h3><p>step01 创建<code>pv(物理卷)</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#88846F;"># 使用/dev/sdb来创建pv</span></span>
<span class="line"><span style="color:#A6E22E;">pvcreate</span><span style="color:#E6DB74;"> /dev/sdb</span></span>
<span class="line"><span style="color:#88846F;">#   Physical volume &quot;/dev/sdb&quot; successfully created.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;"># 查看pv</span></span>
<span class="line"><span style="color:#A6E22E;">pvs</span><span style="color:#E6DB74;"> /dev/sdb</span></span>
<span class="line"><span style="color:#88846F;">#   PV         VG Fmt  Attr PSize  PFree </span></span>
<span class="line"><span style="color:#88846F;">#   /dev/sdb      lvm2 ---  10.00g 10.00g</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;"># 查看pv详细信息</span></span>
<span class="line"><span style="color:#A6E22E;">pvdisplay</span><span style="color:#E6DB74;"> /dev/sdb</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>step02 创建<code>vg(卷组)</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#88846F;"># 基于pv创建vg</span></span>
<span class="line"><span style="color:#A6E22E;">vgcreate</span><span style="color:#E6DB74;"> vgdata</span><span style="color:#E6DB74;"> /dev/sdb</span></span>
<span class="line"><span style="color:#88846F;">#   Volume group &quot;vgdata&quot; successfully created</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;"># 移除vg</span></span>
<span class="line"><span style="color:#A6E22E;">vgremove</span><span style="color:#E6DB74;"> vgdata</span></span>
<span class="line"><span style="color:#88846F;">#   Volume group &quot;vgdata&quot; successfully removed</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;"># 查看vg</span></span>
<span class="line"><span style="color:#A6E22E;">vgs</span><span style="color:#E6DB74;"> vgdata</span></span>
<span class="line"><span style="color:#88846F;">#   VG     #PV #LV #SN Attr   VSize   VFree  </span></span>
<span class="line"><span style="color:#88846F;">#   vgdata   1   0   0 wz--n- &lt;10.00g &lt;10.00g</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;"># 查看vg相信信息</span></span>
<span class="line"><span style="color:#A6E22E;">vgdisplay</span><span style="color:#E6DB74;"> vgdata</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>step03 创建<code>lvm(逻辑卷)</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#88846F;"># 基于vg创建名为data1的lvm并设置大小5G</span></span>
<span class="line"><span style="color:#A6E22E;">lvcreate</span><span style="color:#AE81FF;"> -L</span><span style="color:#E6DB74;"> 5G</span><span style="color:#AE81FF;"> -n</span><span style="color:#E6DB74;"> data1</span><span style="color:#E6DB74;"> /dev/vgdata</span></span>
<span class="line"><span style="color:#88846F;">#   Logical volume &quot;data&quot; created.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;"># 用剩余的空间创建名为data2的lvm</span></span>
<span class="line"><span style="color:#A6E22E;">lvcreate</span><span style="color:#AE81FF;"> -l</span><span style="color:#E6DB74;"> +100%FREE</span><span style="color:#AE81FF;"> -n</span><span style="color:#E6DB74;"> data2</span><span style="color:#E6DB74;"> /dev/vgdata</span></span>
<span class="line"><span style="color:#88846F;">#   Logical volume &quot;data2&quot; created. </span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;"># 查看lv</span></span>
<span class="line"><span style="color:#A6E22E;">lvs</span><span style="color:#E6DB74;"> /dev/vgdata</span></span>
<span class="line"><span style="color:#88846F;">#   LV    VG     Attr       LSize  Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert</span></span>
<span class="line"><span style="color:#88846F;">#   data1 vgdata -wi-a-----  5.00g                                                    </span></span>
<span class="line"><span style="color:#88846F;">#   data2 vgdata -wi-a----- &lt;5.00g</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;"># 查看lv详细信息</span></span>
<span class="line"><span style="color:#A6E22E;">lvdisplay</span><span style="color:#E6DB74;"> /dev/vgdata</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>step04 格式化<code>lvm(逻辑卷)</code>并挂载到对应的文件目录</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#A6E22E;">mkdir</span><span style="color:#E6DB74;"> /data1</span><span style="color:#E6DB74;"> /data2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;"># /dev/vgdata/data1使用ext4格式化并挂载到/data1</span></span>
<span class="line"><span style="color:#A6E22E;">mkfs</span><span style="color:#AE81FF;"> -t</span><span style="color:#E6DB74;"> ext4</span><span style="color:#E6DB74;"> /dev/vgdata/data1</span></span>
<span class="line"><span style="color:#88846F;"># 临时挂载</span></span>
<span class="line"><span style="color:#A6E22E;">mount</span><span style="color:#E6DB74;"> /dev/vgdata/data1</span><span style="color:#E6DB74;"> /data1</span></span>
<span class="line"><span style="color:#88846F;"># 查看块设备UUID</span></span>
<span class="line"><span style="color:#A6E22E;">blkid</span><span style="color:#E6DB74;"> /dev/vgdata/data1</span></span>
<span class="line"><span style="color:#88846F;"># 永久挂载/etc/fstab</span></span>
<span class="line"><span style="color:#F8F8F2;">UUID</span><span style="color:#F92672;">=</span><span style="color:#E6DB74;">4a858fad-bee2-480b-95be-7294c73a4122</span><span style="color:#A6E22E;"> /data1</span><span style="color:#E6DB74;"> ext4</span><span style="color:#E6DB74;"> defaults</span><span style="color:#AE81FF;"> 0</span><span style="color:#AE81FF;"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;"># /dev/vgdata/data2使用xfs格式化并挂载到/data2</span></span>
<span class="line"><span style="color:#A6E22E;">mkfs</span><span style="color:#AE81FF;"> -t</span><span style="color:#E6DB74;"> xfs</span><span style="color:#E6DB74;"> /dev/vgdata/data2</span></span>
<span class="line"><span style="color:#88846F;"># 临时挂载</span></span>
<span class="line"><span style="color:#A6E22E;">mount</span><span style="color:#E6DB74;"> /dev/vgdata/data2</span><span style="color:#E6DB74;"> /data2</span></span>
<span class="line"><span style="color:#88846F;"># 查看块设备UUID</span></span>
<span class="line"><span style="color:#A6E22E;">blkid</span><span style="color:#E6DB74;"> /dev/vgdata/data2</span></span>
<span class="line"><span style="color:#88846F;"># 永久挂载/etc/fstab</span></span>
<span class="line"><span style="color:#F8F8F2;">UUID</span><span style="color:#F92672;">=</span><span style="color:#E6DB74;">c63f7744-5f88-4d60-921a-f70f5b859e5d</span><span style="color:#A6E22E;"> /data2</span><span style="color:#E6DB74;"> xfs</span><span style="color:#E6DB74;"> defaults</span><span style="color:#AE81FF;"> 0</span><span style="color:#AE81FF;"> 0</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="lvm的扩容" tabindex="-1">lvm的扩容 <a class="header-anchor" href="#lvm的扩容" aria-label="Permalink to “lvm的扩容”">​</a></h3><p>step01 创建<code>pv(物理卷)</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#A6E22E;">pvcreate</span><span style="color:#E6DB74;"> /dev/sdc</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>step02 扩容<code>vg(卷组)</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#88846F;"># 扩容vgdata</span></span>
<span class="line"><span style="color:#A6E22E;">vgextend</span><span style="color:#E6DB74;"> vgdata</span><span style="color:#E6DB74;"> /dev/sdc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;"># 查看vg信息</span></span>
<span class="line"><span style="color:#A6E22E;">vgs</span><span style="color:#E6DB74;"> /dev/vgdata</span></span>
<span class="line"><span style="color:#88846F;">#   VG     #PV #LV #SN Attr   VSize  VFree  </span></span>
<span class="line"><span style="color:#88846F;">#   vgdata   2   2   0 wz--n- 19.99g &lt;10.00g</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>step03 扩容<code>lvm(逻辑卷)</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#88846F;"># 扩容/dev/vgdata/data1增加6G</span></span>
<span class="line"><span style="color:#A6E22E;">lvextend</span><span style="color:#AE81FF;"> -L</span><span style="color:#E6DB74;"> +6G</span><span style="color:#E6DB74;"> /dev/vgdata/data1</span><span style="color:#F8F8F2;"> </span></span>
<span class="line"><span style="color:#88846F;">#   Size of logical volume vgdata/data1 changed from 5.00 GiB (1280 extents) to 10.00 GiB (2560 extents).</span></span>
<span class="line"><span style="color:#88846F;">#   Logical volume vgdata/data1 successfully resized.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;"># 刷新、重新设置/dev/vgdata/data1大小</span></span>
<span class="line"><span style="color:#A6E22E;">resize2fs</span><span style="color:#E6DB74;"> /dev/vgdata/data1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;"># 将剩余空间扩容至/dev/vgdata/data2</span></span>
<span class="line"><span style="color:#A6E22E;">lvextend</span><span style="color:#AE81FF;"> -l</span><span style="color:#E6DB74;"> +100%FREE</span><span style="color:#E6DB74;"> /dev/vgdata/data2</span></span>
<span class="line"><span style="color:#88846F;">#   Size of logical volume vgdata/data2 changed from &lt;5.00 GiB (1279 extents) to 8.99 GiB (2302 extents).</span></span>
<span class="line"><span style="color:#88846F;">#   Logical volume vgdata/data2 successfully resized.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;"># 扩容/data2大小</span></span>
<span class="line"><span style="color:#A6E22E;">xfs_growfs</span><span style="color:#E6DB74;"> /data2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div>`,23)])])}const u=a(e,[["render",o]]);export{y as __pageData,u as default};
