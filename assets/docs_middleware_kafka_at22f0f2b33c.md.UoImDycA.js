import{_ as n,a,o as l,a3 as p}from"./chunks/framework.dRMRuUHH.js";const b=JSON.parse('{"title":"kafkaå¿«é€Ÿéƒ¨ç½²å’Œä½¿ç”¨","description":"","frontmatter":{"id":2301,"title":"kafkaå¿«é€Ÿéƒ¨ç½²å’Œä½¿ç”¨","createTime":"2024-03-17 10:00:00","category":"middleware"},"headers":[],"relativePath":"docs/middleware/kafka/at22f0f2b33c.md","filePath":"docs/middleware/kafka/00401_kafka_quickstart.md"}'),e={name:"docs/middleware/kafka/at22f0f2b33c.md"};function o(r,s,c,t,i,F){return l(),a("div",null,[...s[0]||(s[0]=[p(`<div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>æœ¬æ–‡ä½¿ç”¨çš„å®¹å™¨é•œåƒç‰ˆæœ¬ä¸º: <code>zookeeper:3.5.5</code>,<code>kafka:3.0.0</code></p></div><h2 id="docker-composeéƒ¨ç½²kafkaå•èŠ‚ç‚¹" tabindex="-1">docker-composeéƒ¨ç½²kafkaå•èŠ‚ç‚¹ <a class="header-anchor" href="#docker-composeéƒ¨ç½²kafkaå•èŠ‚ç‚¹" aria-label="Permalink to â€œdocker-composeéƒ¨ç½²kafkaå•èŠ‚ç‚¹â€">â€‹</a></h2><div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>ğŸ˜‚ä»…ç”¨äºæµ‹è¯•ç¯å¢ƒ</p></div><p><code>docker-compose.yaml</code>æ–‡ä»¶å†…å®¹</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#F92672;">version</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">&quot;3&quot;</span></span>
<span class="line"><span style="color:#F92672;">services</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">  zookeeper</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">    hostname</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">zookeeper</span></span>
<span class="line"><span style="color:#F92672;">    image</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">zookeeper:3.5.5</span><span style="color:#F8F8F2;"> </span></span>
<span class="line"><span style="color:#F92672;">    container_name</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">zookeeper</span></span>
<span class="line"><span style="color:#F92672;">    volumes</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">./data/zookeeper:/data</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">/etc/localtime:/etc/localtime:ro</span></span>
<span class="line"><span style="color:#F92672;">    ports</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">&quot;2181:2181&quot;</span></span>
<span class="line"><span style="color:#F92672;">    logging</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">      driver</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">json-file</span></span>
<span class="line"><span style="color:#F92672;">      options</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">        max-size</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">100m</span></span>
<span class="line"><span style="color:#F92672;">        max-file</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">&quot;3&quot;</span></span>
<span class="line"><span style="color:#F92672;">    restart</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">on-failure</span></span>
<span class="line"><span style="color:#F92672;">    networks</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">kafka</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">  kafka</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">    hostname</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">kafka</span></span>
<span class="line"><span style="color:#F92672;">    image</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">bitnami/kafka:3.0.0</span><span style="color:#F8F8F2;"> </span></span>
<span class="line"><span style="color:#F92672;">    container_name</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">kafka</span></span>
<span class="line"><span style="color:#F92672;">    user</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">root</span></span>
<span class="line"><span style="color:#F92672;">    volumes</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">./data/kafka:/bitnami/kafka/data</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">/etc/localtime:/etc/localtime:ro</span></span>
<span class="line"><span style="color:#F92672;">    ports</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">&quot;9092:9092&quot;</span></span>
<span class="line"><span style="color:#F92672;">    environment</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">KAFKA_CFG_BROKER_ID=0</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">ALLOW_PLAINTEXT_LISTENER=yes</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">KAFKA_CFG_LISTENERS=PLAINTEXT://0.0.0.0:9092</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">KAFKA_CFG_ADVERTISED_LISTENERS=PLAINTEXT://192.168.10.11:9092</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181</span></span>
<span class="line"><span style="color:#F92672;">    logging</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">      driver</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">json-file</span></span>
<span class="line"><span style="color:#F92672;">      options</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">        max-size</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">100m</span></span>
<span class="line"><span style="color:#F92672;">        max-file</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">&quot;3&quot;</span></span>
<span class="line"><span style="color:#F92672;">    depends_on</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">zookeeper</span></span>
<span class="line"><span style="color:#F92672;">    restart</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">on-failure</span></span>
<span class="line"><span style="color:#F92672;">    networks</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">kafka</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">  kafka-map</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">    hostname</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">kafka-map</span></span>
<span class="line"><span style="color:#F92672;">    image</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">dushixiang/kafka-map:latest</span><span style="color:#F8F8F2;"> </span></span>
<span class="line"><span style="color:#F92672;">    container_name</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">kafka-map</span><span style="color:#F8F8F2;"> </span></span>
<span class="line"><span style="color:#F92672;">    volumes</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">./data/kafka-map:/usr/local/kafka-map/data</span></span>
<span class="line"><span style="color:#F92672;">    environment</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">DEFAULT_USERNAME=admin</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">DEFAULT_PASSWORD=admin123</span></span>
<span class="line"><span style="color:#F92672;">    ports</span><span style="color:#F8F8F2;">:                              </span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">&quot;8080:8080&quot;</span></span>
<span class="line"><span style="color:#F92672;">    depends_on</span><span style="color:#F8F8F2;">:                  </span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">zookeeper</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">kafka</span></span>
<span class="line"><span style="color:#F92672;">    restart</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">on-failure</span></span>
<span class="line"><span style="color:#F92672;">    networks</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">kafka</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">networks</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">  kafka</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">    driver</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">bridge</span></span>
<span class="line"><span style="color:#F92672;">    ipam</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">      config</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">        - </span><span style="color:#F92672;">subnet</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">172.40.0.0/16</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br></div></div><h2 id="docker-composeéƒ¨ç½²kafkaé›†ç¾¤" tabindex="-1">docker-composeéƒ¨ç½²kafkaé›†ç¾¤ <a class="header-anchor" href="#docker-composeéƒ¨ç½²kafkaé›†ç¾¤" aria-label="Permalink to â€œdocker-composeéƒ¨ç½²kafkaé›†ç¾¤â€">â€‹</a></h2><p>åˆ›å»ºéœ€è¦æŒ‚è½½çš„ç›®å½•</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#A6E22E;">mkdir</span><span style="color:#AE81FF;"> -p</span><span style="color:#E6DB74;"> data/zookeeper0{1..3}</span><span style="color:#E6DB74;"> data/kafka0{1..2}</span><span style="color:#E6DB74;"> data/kafka-map</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>åˆ›å»º<code>zookeeper</code>é›†ç¾¤é…ç½®æ–‡ä»¶</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#A6E22E;">cat</span><span style="color:#F92672;"> &gt;</span><span style="color:#E6DB74;"> data/zoo.cfg</span><span style="color:#F92672;"> &lt;&lt;</span><span style="color:#F8F8F2;"> EOF</span></span>
<span class="line"><span style="color:#E6DB74;"># æ•°æ®ç›®å½•</span></span>
<span class="line"><span style="color:#E6DB74;">dataDir=/data</span></span>
<span class="line"><span style="color:#E6DB74;">dataLogDir=/datalog</span></span>
<span class="line"><span style="color:#E6DB74;"># å¿ƒè·³æ—¶é—´</span></span>
<span class="line"><span style="color:#E6DB74;">tickTime=2000</span></span>
<span class="line"><span style="color:#E6DB74;"># å®¢æˆ·ç«¯ç«¯å£</span></span>
<span class="line"><span style="color:#E6DB74;">clientPort=2181</span></span>
<span class="line"><span style="color:#E6DB74;"># followå’Œleaderä¹‹é—´åˆå§‹è¿æ¥æ—¶èƒ½å®¹å¿çš„æœ€å¤šå¿ƒè·³æ•°</span></span>
<span class="line"><span style="color:#E6DB74;">initLimit=5</span></span>
<span class="line"><span style="color:#E6DB74;"># followå’Œleaderä¹‹é—´è¯·æ±‚å’Œåº”ç­”æ—¶èƒ½å®¹å¿çš„æœ€å¤šå¿ƒè·³æ•°</span></span>
<span class="line"><span style="color:#E6DB74;">syncLimit=2</span></span>
<span class="line"><span style="color:#E6DB74;"># ä¿å­˜å¿«ç…§çš„æ•°é‡å’Œå®šæ—¶æ¸…ç†å¿«ç…§çš„æ—¶é—´</span></span>
<span class="line"><span style="color:#E6DB74;">autopurge.snapRetainCount=3</span></span>
<span class="line"><span style="color:#E6DB74;">autopurge.purgeInterval=1</span></span>
<span class="line"><span style="color:#E6DB74;"># æœ€å¤§çš„å®¢æˆ·ç«¯è¿æ¥æ•°</span></span>
<span class="line"><span style="color:#E6DB74;">maxClientCnxns=60</span></span>
<span class="line"><span style="color:#E6DB74;"># standaloneEnabled=true</span></span>
<span class="line"><span style="color:#E6DB74;"># admin.enableServer=true</span></span>
<span class="line"><span style="color:#E6DB74;"># é›†ç¾¤é…ç½®,2888ä¸»ä»é€šä¿¡ç«¯å£,3888ç”¨æ¥é€‰ä¸¾leader</span></span>
<span class="line"><span style="color:#E6DB74;">server.1=zookeeper01:2888:3888;2181</span></span>
<span class="line"><span style="color:#E6DB74;">server.2=zookeeper02:2888:3888;2181</span></span>
<span class="line"><span style="color:#E6DB74;">server.3=zookeeper03:2888:3888;2181</span></span>
<span class="line"><span style="color:#F8F8F2;">EOF</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>ç»™<code>zookeeper</code>é›†ç¾¤åˆ†é…èŠ‚ç‚¹id</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#F92672;">for</span><span style="color:#F8F8F2;"> i </span><span style="color:#F92672;">in</span><span style="color:#E6DB74;"> \`</span><span style="color:#A6E22E;">seq</span><span style="color:#AE81FF;"> 3</span><span style="color:#E6DB74;">\`</span><span style="color:#F8F8F2;">;</span><span style="color:#F92672;">do</span><span style="color:#F8F8F2;"> echo $i </span><span style="color:#F92672;">&gt;</span><span style="color:#F8F8F2;"> data/zookeeper0$i/myid ;</span><span style="color:#F92672;">done</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><code>docker-compose.yaml</code>æ–‡ä»¶å†…å®¹</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#F92672;">version</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">&quot;3&quot;</span></span>
<span class="line"><span style="color:#F92672;">services</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">  zookeeper01</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">    hostname</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">zookeeper01</span></span>
<span class="line"><span style="color:#F92672;">    image</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">zookeeper:3.5.5</span><span style="color:#F8F8F2;"> </span></span>
<span class="line"><span style="color:#F92672;">    container_name</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">zookeeper01</span></span>
<span class="line"><span style="color:#F92672;">    volumes</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">./data/zookeeper01:/data</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">./data/zoo.cfg:/conf/zoo.cfg</span><span style="color:#F8F8F2;">   </span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">/etc/localtime:/etc/localtime:ro</span></span>
<span class="line"><span style="color:#F92672;">    ports</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">&quot;2181:2181&quot;</span></span>
<span class="line"><span style="color:#F92672;">    logging</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">      driver</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">json-file</span></span>
<span class="line"><span style="color:#F92672;">      options</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">        max-size</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">100m</span></span>
<span class="line"><span style="color:#F92672;">        max-file</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">&quot;3&quot;</span></span>
<span class="line"><span style="color:#F92672;">    restart</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">on-failure</span></span>
<span class="line"><span style="color:#F92672;">    networks</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">kafka</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">  zookeeper02</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">    hostname</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">zookeeper02</span></span>
<span class="line"><span style="color:#F92672;">    image</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">zookeeper:3.5.5</span><span style="color:#F8F8F2;"> </span></span>
<span class="line"><span style="color:#F92672;">    container_name</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">zookeeper02</span></span>
<span class="line"><span style="color:#F92672;">    volumes</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">./data/zookeeper02:/data</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">./data/zoo.cfg:/conf/zoo.cfg</span><span style="color:#F8F8F2;">   </span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">/etc/localtime:/etc/localtime:ro</span></span>
<span class="line"><span style="color:#F92672;">    ports</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">&quot;2182:2181&quot;</span></span>
<span class="line"><span style="color:#F92672;">    logging</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">      driver</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">json-file</span></span>
<span class="line"><span style="color:#F92672;">      options</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">        max-size</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">100m</span></span>
<span class="line"><span style="color:#F92672;">        max-file</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">&quot;3&quot;</span></span>
<span class="line"><span style="color:#F92672;">    restart</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">on-failure</span></span>
<span class="line"><span style="color:#F92672;">    depends_on</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">zookeeper01</span></span>
<span class="line"><span style="color:#F92672;">    networks</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">kafka</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">  zookeeper03</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">    hostname</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">zookeeper03</span></span>
<span class="line"><span style="color:#F92672;">    image</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">zookeeper:3.5.5</span><span style="color:#F8F8F2;"> </span></span>
<span class="line"><span style="color:#F92672;">    container_name</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">zookeeper03</span></span>
<span class="line"><span style="color:#F92672;">    volumes</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">./data/zookeeper03:/data</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">./data/zoo.cfg:/conf/zoo.cfg</span><span style="color:#F8F8F2;">   </span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">/etc/localtime:/etc/localtime:ro</span></span>
<span class="line"><span style="color:#F92672;">    ports</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">&quot;2183:2181&quot;</span></span>
<span class="line"><span style="color:#F92672;">    logging</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">      driver</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">json-file</span></span>
<span class="line"><span style="color:#F92672;">      options</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">        max-size</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">100m</span></span>
<span class="line"><span style="color:#F92672;">        max-file</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">&quot;3&quot;</span></span>
<span class="line"><span style="color:#F92672;">    restart</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">on-failure</span></span>
<span class="line"><span style="color:#F92672;">    depends_on</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">zookeeper01</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">zookeeper02</span></span>
<span class="line"><span style="color:#F92672;">    networks</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">kafka</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">  kafka01</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">    hostname</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">kafka01</span></span>
<span class="line"><span style="color:#F92672;">    image</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">bitnami/kafka:3.0.0</span><span style="color:#F8F8F2;"> </span></span>
<span class="line"><span style="color:#F92672;">    container_name</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">kafka01</span></span>
<span class="line"><span style="color:#F92672;">    user</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">root</span></span>
<span class="line"><span style="color:#F92672;">    volumes</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">./data/kafka01:/bitnami/kafka/data</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">/etc/localtime:/etc/localtime:ro</span></span>
<span class="line"><span style="color:#F92672;">    ports</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">&quot;9093:9093&quot;</span></span>
<span class="line"><span style="color:#F92672;">    environment</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">KAFKA_CFG_BROKER_ID=1</span><span style="color:#88846F;"> # broker idå…¨å±€å”¯ä¸€</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">ALLOW_PLAINTEXT_LISTENER=yes</span><span style="color:#88846F;"> #å…è®¸ä½¿ç”¨PLAINTEXTç›‘å¬å™¨</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">KAFKA_CFG_INTER_BROKER_LISTENER_NAME=INTERNAL</span><span style="color:#88846F;"> # ç”¨äºé…ç½®brokerä¹‹é—´é€šä¿¡ä½¿ç”¨çš„ç›‘å¬å™¨åç§°</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">KAFKA_CFG_LISTENER_SECURITY_PROTOCOL_MAP=INTERNAL:PLAINTEXT,EXTERNAL:PLAINTEXT</span><span style="color:#88846F;"> # ç›‘å¬çš„åè®®é›†åˆå¤šä¸ª,è¿™é‡ŒINTERNALæŒ‡çš„æ˜¯å†…éƒ¨,EXTERNALæ˜¯å¤–éƒ¨</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">KAFKA_CFG_LISTENERS=INTERNAL://0.0.0.0:9092,EXTERNAL://0.0.0.0:9093</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">KAFKA_CFG_ADVERTISED_LISTENERS=INTERNAL://kafka01:9092,EXTERNAL://192.168.10.11:9093</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">KAFKA_CFG_ZOOKEEPER_CONNECT=zookeeper01:2181,zookeeper02:2181,zookeeper03:2181</span><span style="color:#88846F;"> # zookeeperé›†ç¾¤åœ°å€</span></span>
<span class="line"><span style="color:#F92672;">    logging</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">      driver</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">json-file</span></span>
<span class="line"><span style="color:#F92672;">      options</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">        max-size</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">100m</span></span>
<span class="line"><span style="color:#F92672;">        max-file</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">&quot;3&quot;</span></span>
<span class="line"><span style="color:#F92672;">    depends_on</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">zookeeper03</span></span>
<span class="line"><span style="color:#F92672;">    restart</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">on-failure</span></span>
<span class="line"><span style="color:#F92672;">    networks</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">kafka</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">  kafka02</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">    hostname</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">kafka02</span></span>
<span class="line"><span style="color:#F92672;">    image</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">bitnami/kafka:3.0.0</span><span style="color:#F8F8F2;"> </span></span>
<span class="line"><span style="color:#F92672;">    container_name</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">kafka02</span></span>
<span class="line"><span style="color:#F92672;">    user</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">root</span></span>
<span class="line"><span style="color:#F92672;">    volumes</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">./data/kafka02:/bitnami/kafka/data</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">/etc/localtime:/etc/localtime:ro</span></span>
<span class="line"><span style="color:#F92672;">    ports</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">&quot;9094:9094&quot;</span></span>
<span class="line"><span style="color:#F92672;">    environment</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">KAFKA_CFG_BROKER_ID=2</span><span style="color:#88846F;"> # broker idå…¨å±€å”¯ä¸€</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">ALLOW_PLAINTEXT_LISTENER=yes</span><span style="color:#88846F;"> #å…è®¸ä½¿ç”¨PLAINTEXTç›‘å¬å™¨</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">KAFKA_CFG_INTER_BROKER_LISTENER_NAME=INTERNAL</span><span style="color:#88846F;"> # ç”¨äºé…ç½®brokerä¹‹é—´é€šä¿¡ä½¿ç”¨çš„ç›‘å¬å™¨åç§°</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">KAFKA_CFG_LISTENER_SECURITY_PROTOCOL_MAP=INTERNAL:PLAINTEXT,EXTERNAL:PLAINTEXT</span><span style="color:#88846F;"> # ç›‘å¬çš„åè®®é›†åˆå¤šä¸ª,è¿™é‡ŒINTERNALæŒ‡çš„æ˜¯å†…éƒ¨,EXTERNALæ˜¯å¤–éƒ¨</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">KAFKA_CFG_LISTENERS=INTERNAL://0.0.0.0:9092,EXTERNAL://0.0.0.0:9094</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">KAFKA_CFG_ADVERTISED_LISTENERS=INTERNAL://kafka02:9092,EXTERNAL://192.168.10.11:9094</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">KAFKA_CFG_ZOOKEEPER_CONNECT=zookeeper01:2181,zookeeper02:2181,zookeeper03:2181</span><span style="color:#88846F;"> # zookeeperé›†ç¾¤åœ°å€</span></span>
<span class="line"><span style="color:#F92672;">    logging</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">      driver</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">json-file</span></span>
<span class="line"><span style="color:#F92672;">      options</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">        max-size</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">100m</span></span>
<span class="line"><span style="color:#F92672;">        max-file</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">&quot;3&quot;</span></span>
<span class="line"><span style="color:#F92672;">    depends_on</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">zookeeper03</span></span>
<span class="line"><span style="color:#F92672;">    restart</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">on-failure</span></span>
<span class="line"><span style="color:#F92672;">    networks</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">kafka</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">  kafka-map</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">    hostname</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">kafka-map</span></span>
<span class="line"><span style="color:#F92672;">    image</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">dushixiang/kafka-map:latest</span></span>
<span class="line"><span style="color:#F92672;">    container_name</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">kafka-map</span></span>
<span class="line"><span style="color:#F92672;">    volumes</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">./data/kafka-map:/usr/local/kafka-map/data</span></span>
<span class="line"><span style="color:#F92672;">    ports</span><span style="color:#F8F8F2;">:                              </span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">&quot;8080:8080&quot;</span></span>
<span class="line"><span style="color:#F92672;">    environment</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">DEFAULT_USERNAME=admin</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">DEFAULT_PASSWORD=admin123</span></span>
<span class="line"><span style="color:#F92672;">    logging</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">      driver</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">json-file</span></span>
<span class="line"><span style="color:#F92672;">      options</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">        max-size</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">100m</span></span>
<span class="line"><span style="color:#F92672;">        max-file</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">&quot;3&quot;</span></span>
<span class="line"><span style="color:#F92672;">    restart</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">on-failure</span></span>
<span class="line"><span style="color:#F92672;">    networks</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      - </span><span style="color:#E6DB74;">kafka</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">networks</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">  kafka</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">    driver</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">bridge</span></span>
<span class="line"><span style="color:#F92672;">    ipam</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">      config</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">        - </span><span style="color:#F92672;">subnet</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">172.40.0.0/16</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br></div></div><h2 id="ç›¸å…³å‘½ä»¤è¡Œ" tabindex="-1">ç›¸å…³å‘½ä»¤è¡Œ <a class="header-anchor" href="#ç›¸å…³å‘½ä»¤è¡Œ" aria-label="Permalink to â€œç›¸å…³å‘½ä»¤è¡Œâ€">â€‹</a></h2><h3 id="æ£€æŸ¥zookeeperé›†ç¾¤çŠ¶æ€" tabindex="-1">æ£€æŸ¥zookeeperé›†ç¾¤çŠ¶æ€ <a class="header-anchor" href="#æ£€æŸ¥zookeeperé›†ç¾¤çŠ¶æ€" aria-label="Permalink to â€œæ£€æŸ¥zookeeperé›†ç¾¤çŠ¶æ€â€">â€‹</a></h3><p>æŸ¥çœ‹<code>zookeeper</code>é›†ç¾¤çŠ¶æ€ï¼Œå…¶ä¸­<code>Mode: follower</code>ä¸ºä»èŠ‚ç‚¹ï¼Œ<code>Mode: leader</code>ä¸ºé€‰ä¸¾çš„ä¸»èŠ‚ç‚¹</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#A6E22E;">docker</span><span style="color:#E6DB74;"> exec</span><span style="color:#AE81FF;"> -it</span><span style="color:#E6DB74;"> zookeeper01</span><span style="color:#E6DB74;"> ./bin/zkServer.sh</span><span style="color:#E6DB74;"> status</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>ç™»å½•<code>zookeeper</code>å®¢æˆ·ç«¯æŸ¥çœ‹<code>zookeeper</code>é›†ç¾¤ä¿¡æ¯</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#A6E22E;">ls</span><span style="color:#E6DB74;"> /zookeeper</span></span>
<span class="line"><span style="color:#88846F;"># [config, quota]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E;">get</span><span style="color:#E6DB74;"> /zookeeper/config</span></span>
<span class="line"><span style="color:#88846F;"># server.1=zookeeper01:2888:3888:participant;0.0.0.0:2181</span></span>
<span class="line"><span style="color:#88846F;"># server.2=zookeeper02:2888:3888:participant;0.0.0.0:2181</span></span>
<span class="line"><span style="color:#88846F;"># server.3=zookeeper03:2888:3888:participant;0.0.0.0:2181</span></span>
<span class="line"><span style="color:#88846F;"># version=0</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="æŸ¥çœ‹brokeræ³¨å†Œä¿¡æ¯" tabindex="-1">æŸ¥çœ‹brokeræ³¨å†Œä¿¡æ¯ <a class="header-anchor" href="#æŸ¥çœ‹brokeræ³¨å†Œä¿¡æ¯" aria-label="Permalink to â€œæŸ¥çœ‹brokeræ³¨å†Œä¿¡æ¯â€">â€‹</a></h3><p>ç™»å½•<code>zookeeper</code>å®¢æˆ·ç«¯æŸ¥çœ‹<code>kafka broker</code>æ³¨å†Œä¿¡æ¯</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#A6E22E;">ls</span><span style="color:#E6DB74;"> /brokers/ids</span></span>
<span class="line"><span style="color:#88846F;"># [1, 2]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E;">get</span><span style="color:#E6DB74;"> /brokers/ids/1</span></span>
<span class="line"><span style="color:#88846F;"># {&quot;listener_security_protocol_map&quot;:{&quot;INTERNAL&quot;:&quot;PLAINTEXT&quot;,&quot;EXTERNAL&quot;:&quot;PLAINTEXT&quot;},&quot;endpoints&quot;:[&quot;INTERNAL://kafka01:9092&quot;,&quot;EXTERNAL://192.168.10.11:9093&quot;],&quot;jmx_port&quot;:-1,&quot;features&quot;:{},&quot;host&quot;:&quot;kafka01&quot;,&quot;timestamp&quot;:&quot;1710782861074&quot;,&quot;port&quot;:9092,&quot;version&quot;:5}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E;">get</span><span style="color:#E6DB74;"> /brokers/ids/2</span></span>
<span class="line"><span style="color:#88846F;"># {&quot;listener_security_protocol_map&quot;:{&quot;INTERNAL&quot;:&quot;PLAINTEXT&quot;,&quot;EXTERNAL&quot;:&quot;PLAINTEXT&quot;},&quot;endpoints&quot;:[&quot;INTERNAL://kafka02:9092&quot;,&quot;EXTERNAL://192.168.10.11:9094&quot;],&quot;jmx_port&quot;:-1,&quot;features&quot;:{},&quot;host&quot;:&quot;kafka02&quot;,&quot;timestamp&quot;:&quot;1710782890247&quot;,&quot;port&quot;:9092,&quot;version&quot;:5}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="topicç®¡ç†" tabindex="-1">topicç®¡ç† <a class="header-anchor" href="#topicç®¡ç†" aria-label="Permalink to â€œtopicç®¡ç†â€">â€‹</a></h3><p>åˆ›å»º<code>topic</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#A6E22E;">./bin/kafka-topics.sh</span><span style="color:#AE81FF;"> --bootstrap-server</span><span style="color:#E6DB74;"> localhost:9092</span><span style="color:#AE81FF;"> --create</span><span style="color:#AE81FF;"> --topic</span><span style="color:#E6DB74;"> topic01</span><span style="color:#AE81FF;"> --partitions</span><span style="color:#AE81FF;"> 2</span><span style="color:#AE81FF;"> --replication-factor=2</span><span style="color:#F8F8F2;">        </span></span>
<span class="line"><span style="color:#88846F;"># Created topic topic01.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>æŸ¥çœ‹æ‰€æœ‰<code>topic</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#A6E22E;">./bin/kafka-topics.sh</span><span style="color:#AE81FF;"> --bootstrap-server</span><span style="color:#E6DB74;"> localhost:9092</span><span style="color:#AE81FF;"> --list</span></span>
<span class="line"><span style="color:#88846F;"># __consumer_offsets</span></span>
<span class="line"><span style="color:#88846F;"># topic01</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>æŸ¥çœ‹æŒ‡å®šçš„<code>topic</code>ä¿¡æ¯</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#A6E22E;">./bin/kafka-topics.sh</span><span style="color:#AE81FF;"> --bootstrap-server</span><span style="color:#E6DB74;"> localhost:9092</span><span style="color:#AE81FF;"> --describe</span><span style="color:#AE81FF;"> --topic</span><span style="color:#E6DB74;"> topic01</span></span>
<span class="line"><span style="color:#88846F;"># Topic: topic01	TopicId: cjNJWFhGQjaLkqTryTr4Og	PartitionCount: 2	ReplicationFactor: 2	Configs: segment.bytes=1073741824</span></span>
<span class="line"><span style="color:#88846F;"># 	Topic: topic01	Partition: 0	Leader: 1	Replicas: 1,2	Isr: 1,2</span></span>
<span class="line"><span style="color:#88846F;"># 	Topic: topic01	Partition: 1	Leader: 2	Replicas: 2,1	Isr: 2,1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="ç”Ÿäº§æ¶ˆè´¹æµ‹è¯•" tabindex="-1">ç”Ÿäº§æ¶ˆè´¹æµ‹è¯• <a class="header-anchor" href="#ç”Ÿäº§æ¶ˆè´¹æµ‹è¯•" aria-label="Permalink to â€œç”Ÿäº§æ¶ˆè´¹æµ‹è¯•â€">â€‹</a></h3><p>ç”Ÿäº§æ¶ˆæ¯</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#A6E22E;">./kafka-console-producer.sh</span><span style="color:#AE81FF;"> --bootstrap-server</span><span style="color:#E6DB74;"> localhost:9092</span><span style="color:#AE81FF;"> --topic</span><span style="color:#E6DB74;"> topic01</span></span>
<span class="line"><span style="color:#88846F;"># &gt;task01</span></span>
<span class="line"><span style="color:#88846F;"># &gt;task02</span></span>
<span class="line"><span style="color:#88846F;"># &gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>æ¶ˆè´¹æ¶ˆæ¯</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#A6E22E;">./kafka-console-consumer.sh</span><span style="color:#AE81FF;"> --bootstrap-server</span><span style="color:#E6DB74;"> localhost:9092</span><span style="color:#AE81FF;"> --topic</span><span style="color:#E6DB74;"> topic01</span></span>
<span class="line"><span style="color:#88846F;"># task01</span></span>
<span class="line"><span style="color:#88846F;"># task02</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="é‡åˆ°çš„é—®é¢˜" tabindex="-1">é‡åˆ°çš„é—®é¢˜ <a class="header-anchor" href="#é‡åˆ°çš„é—®é¢˜" aria-label="Permalink to â€œé‡åˆ°çš„é—®é¢˜â€">â€‹</a></h2><h3 id="zookeeperæœåŠ¡å¯åŠ¨å¤±è´¥" tabindex="-1">zookeeperæœåŠ¡å¯åŠ¨å¤±è´¥ <a class="header-anchor" href="#zookeeperæœåŠ¡å¯åŠ¨å¤±è´¥" aria-label="Permalink to â€œzookeeperæœåŠ¡å¯åŠ¨å¤±è´¥â€">â€‹</a></h3><p>æŸ¥çœ‹æœåŠ¡çŠ¶æ€</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#A6E22E;">docker</span><span style="color:#E6DB74;"> exec</span><span style="color:#AE81FF;"> -it</span><span style="color:#E6DB74;"> zookeeper01</span><span style="color:#E6DB74;"> ./bin/zkServer.sh</span><span style="color:#E6DB74;"> status</span></span>
<span class="line"><span style="color:#88846F;"># ZooKeeper JMX enabled by default</span></span>
<span class="line"><span style="color:#88846F;"># Using config: /conf/zoo.cfg</span></span>
<span class="line"><span style="color:#88846F;"># Client port found: 2181. Client address: localhost.</span></span>
<span class="line"><span style="color:#88846F;"># Error contacting service. It is probably not running.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>æ—¥å¿—æ˜¾ç¤º</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#F8F8F2;">[myid:1] - WARN  [NIOWorkerThread-1:NIOServerCnxn@370] - Exception causing close of session 0x0: ZooKeeperServer not running</span></span>
<span class="line"><span style="color:#F8F8F2;">[myid:1] - INFO  [QuorumPeer[myid</span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;">1](plain</span><span style="color:#F92672;">=/</span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">0</span><span style="color:#F92672;">:</span><span style="color:#AE81FF;">2181</span><span style="color:#F8F8F2;">)(secure</span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;">disabled):QuorumCnxManager@430] - Have smaller server identifier, so dropping the connection: (</span><span style="color:#A6E22E;">2,</span><span style="color:#AE81FF;"> 1</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">[myid:1] - INFO  [QuorumPeer[myid</span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;">1](plain</span><span style="color:#F92672;">=/</span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">0</span><span style="color:#F92672;">:</span><span style="color:#AE81FF;">2181</span><span style="color:#F8F8F2;">)(secure</span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;">disabled):QuorumCnxManager@430] - Have smaller server identifier, so dropping the connection: (</span><span style="color:#A6E22E;">3,</span><span style="color:#AE81FF;"> 1</span><span style="color:#F8F8F2;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>zookeeper</code>é›†ç¾¤åœ¨å¯åŠ¨æ—¶éœ€è¦æŒ‰ç…§<code>myid</code>ä»å°åˆ°å¤§çš„é¡ºåºæ¥å¯åŠ¨</p><h3 id="kafkaå¯åŠ¨å¤±è´¥" tabindex="-1">kafkaå¯åŠ¨å¤±è´¥ <a class="header-anchor" href="#kafkaå¯åŠ¨å¤±è´¥" aria-label="Permalink to â€œkafkaå¯åŠ¨å¤±è´¥â€">â€‹</a></h3><p>æ—¥å¿—æ˜¾ç¤º</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#A6E22E;">ERROR</span><span style="color:#E6DB74;"> Fatal</span><span style="color:#E6DB74;"> error</span><span style="color:#E6DB74;"> during</span><span style="color:#E6DB74;"> KafkaServer</span><span style="color:#E6DB74;"> startup.</span><span style="color:#E6DB74;"> Prepare</span><span style="color:#E6DB74;"> to</span><span style="color:#E6DB74;"> shutdown</span><span style="color:#F8F8F2;"> (kafka.server.KafkaServer)</span></span>
<span class="line"><span style="color:#A6E22E;">kafka.common.InconsistentClusterIdException:</span><span style="color:#E6DB74;"> The</span><span style="color:#E6DB74;"> Cluster</span><span style="color:#E6DB74;"> ID</span><span style="color:#E6DB74;"> CbqG-ZOgTWKPFsdZinWJug</span><span style="color:#E6DB74;"> doesn&#39;t match stored clusterId Some(lTfRgejGQ_ipngoCuI9RnQ) in meta.properties. The broker is trying to join the wrong cluster. Configured zookeeper.connect may be wrong.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>æ˜¯ç”±äº<code>kafka</code>å½“å‰çš„<code>cluster.id</code>ä¸<code>meta.properties</code>æ–‡ä»¶ä¸­è®°å½•çš„<code>cluster.id</code>ä¸ä¸€è‡´å¯¼è‡´çš„ï¼Œéœ€è¦åˆ é™¤<code>meta.properties</code>æ–‡ä»¶åé‡æ–°å¯åŠ¨<code>kafka</code>æœåŠ¡</p>`,46)])])}const u=n(e,[["render",o]]);export{b as __pageData,u as default};
