import{_ as n,a,o as l,a3 as e}from"./chunks/framework.dRMRuUHH.js";const b=JSON.parse('{"title":"nginxé…ç½®ssl","description":"","frontmatter":{"id":2003,"title":"nginxé…ç½®ssl","createTime":"2023-12-29 19:26:01","category":"middleware"},"headers":[],"relativePath":"docs/middleware/nginx/at2kf0f2b3yd.md","filePath":"docs/middleware/nginx/00103_nginx_config_ssl.md"}'),p={name:"docs/middleware/nginx/at2kf0f2b3yd.md"};function r(o,s,c,t,i,F){return l(),a("div",null,[...s[0]||(s[0]=[e(`<h2 id="nginxé…ç½®sslå’ŒæœåŠ¡ç«¯è¯ä¹¦" tabindex="-1">nginxé…ç½®sslå’ŒæœåŠ¡ç«¯è¯ä¹¦ <a class="header-anchor" href="#nginxé…ç½®sslå’ŒæœåŠ¡ç«¯è¯ä¹¦" aria-label="Permalink to â€œnginxé…ç½®sslå’ŒæœåŠ¡ç«¯è¯ä¹¦â€">â€‹</a></h2><div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>ğŸ‘‰<a href="/vdocs/docs/linux/at2yf0f2b3zx.html">å¦‚ä½•ç”Ÿæˆè‡ªç­¾è¯ä¹¦</a></p><p>ğŸ˜‚è‡ªç­¾è¯ä¹¦ä»…ç”¨äºæµ‹è¯•ï¼Œç”Ÿäº§ç¯å¢ƒè¿˜è¯·è´­ä¹°è¯ä¹¦</p></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#A6E22E;">server</span><span style="color:#E6DB74;"> {</span></span>
<span class="line"><span style="color:#88846F;">    # é…ç½®httpsç«¯å£</span></span>
<span class="line"><span style="color:#A6E22E;">    listen</span><span style="color:#AE81FF;"> 443</span><span style="color:#E6DB74;"> ssl</span><span style="color:#E6DB74;"> default_server</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#A6E22E;">    server_name</span><span style="color:#E6DB74;"> www.kana.com</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">     </span></span>
<span class="line"><span style="color:#88846F;">    # æŒ‡å®šsslåè®®</span></span>
<span class="line"><span style="color:#A6E22E;">    ssl_protocols</span><span style="color:#E6DB74;"> TLSv1</span><span style="color:#E6DB74;"> TLSv1.1</span><span style="color:#E6DB74;"> TLSv1.2</span><span style="color:#E6DB74;"> TLSv1.3</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#88846F;">    # é…ç½®sslåŠ å¯†å¥—ä»¶</span></span>
<span class="line"><span style="color:#A6E22E;">    ssl_ciphers</span><span style="color:#E6DB74;"> ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#88846F;">    # åå•†åŠ å¯†ç®—æ³•æ—¶ä¼˜å…ˆæœåŠ¡ç«¯åŠ å¯†ç®—æ³•</span></span>
<span class="line"><span style="color:#A6E22E;">    ssl_prefer_server_ciphers</span><span style="color:#E6DB74;"> on</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">    # é…ç½®æœåŠ¡ç«¯è¯ä¹¦è·¯å¾„</span></span>
<span class="line"><span style="color:#A6E22E;">    ssl_certificate</span><span style="color:#E6DB74;"> /etc/nginx/certs/server/server.crt</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#88846F;">    # é…ç½®æœåŠ¡ç«¯ç§é’¥è·¯å¾„</span></span>
<span class="line"><span style="color:#A6E22E;">    ssl_certificate_key</span><span style="color:#E6DB74;"> /etc/nginx/certs/server/server.key</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#88846F;">    # é…ç½®caè¯ä¹¦è·¯å¾„ç”¨äºéªŒè¯å®¢æˆ·ç«¯è¯ä¹¦</span></span>
<span class="line"><span style="color:#A6E22E;">    ssl_client_certificate</span><span style="color:#E6DB74;"> /etc/nginx/certs/ca/ca.crt</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#88846F;">    # æ˜¯å¦å¯ç”¨å®¢æˆ·ç«¯è¯ä¹¦éªŒè¯</span></span>
<span class="line"><span style="color:#A6E22E;">    ssl_verify_client</span><span style="color:#E6DB74;"> on</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E;">    location</span><span style="color:#E6DB74;"> /</span><span style="color:#E6DB74;"> {</span></span>
<span class="line"><span style="color:#A6E22E;">        default_type</span><span style="color:#E6DB74;"> text/plain</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F92672;">        return</span><span style="color:#AE81FF;"> 200</span><span style="color:#E6DB74;"> &quot;default page\\n&quot;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h2 id="httpè¯·æ±‚è½¬å‘åˆ°https" tabindex="-1">httpè¯·æ±‚è½¬å‘åˆ°https <a class="header-anchor" href="#httpè¯·æ±‚è½¬å‘åˆ°https" aria-label="Permalink to â€œhttpè¯·æ±‚è½¬å‘åˆ°httpsâ€">â€‹</a></h2><h3 id="ä½¿ç”¨æ°¸ä¹…é‡å®šå‘è·³è½¬" tabindex="-1">ä½¿ç”¨æ°¸ä¹…é‡å®šå‘è·³è½¬ <a class="header-anchor" href="#ä½¿ç”¨æ°¸ä¹…é‡å®šå‘è·³è½¬" aria-label="Permalink to â€œä½¿ç”¨æ°¸ä¹…é‡å®šå‘è·³è½¬â€">â€‹</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#A6E22E;">server</span><span style="color:#E6DB74;"> {</span></span>
<span class="line"><span style="color:#A6E22E;">    listen</span><span style="color:#AE81FF;">       80</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#A6E22E;">    server_name</span><span style="color:#E6DB74;"> www.kana.com</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span></span>
<span class="line"><span style="color:#F92672;">    return</span><span style="color:#AE81FF;"> 301</span><span style="color:#E6DB74;"> https://</span><span style="color:#F8F8F2;">$host$request_uri;</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="ä½¿ç”¨rewriteé‡å†™" tabindex="-1">ä½¿ç”¨rewriteé‡å†™ <a class="header-anchor" href="#ä½¿ç”¨rewriteé‡å†™" aria-label="Permalink to â€œä½¿ç”¨rewriteé‡å†™â€">â€‹</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#A6E22E;">server</span><span style="color:#E6DB74;"> {</span></span>
<span class="line"><span style="color:#A6E22E;">    listen</span><span style="color:#AE81FF;">       80</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#A6E22E;">    listen</span><span style="color:#F8F8F2;">  [::]:80;</span></span>
<span class="line"><span style="color:#A6E22E;">    server_name</span><span style="color:#E6DB74;"> www.kana.com</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span></span>
<span class="line"><span style="color:#A6E22E;">    rewrite</span><span style="color:#E6DB74;"> ^</span><span style="color:#F8F8F2;">(</span><span style="color:#66D9EF;">.</span><span style="color:#E6DB74;">*</span><span style="color:#F8F8F2;">) </span><span style="color:#E6DB74;">https://</span><span style="color:#F8F8F2;">$server_name</span><span style="color:#FD971F;font-style:italic;">$1</span><span style="color:#E6DB74;"> permanent</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="ä½¿ç”¨error-pageä¸´æ—¶é‡å®šå‘" tabindex="-1">ä½¿ç”¨error_pageä¸´æ—¶é‡å®šå‘ <a class="header-anchor" href="#ä½¿ç”¨error-pageä¸´æ—¶é‡å®šå‘" aria-label="Permalink to â€œä½¿ç”¨error_pageä¸´æ—¶é‡å®šå‘â€">â€‹</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#A6E22E;">server</span><span style="color:#E6DB74;"> {</span></span>
<span class="line"><span style="color:#A6E22E;">    listen</span><span style="color:#AE81FF;"> 80</span><span style="color:#E6DB74;"> ssl</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#A6E22E;">    listen</span><span style="color:#AE81FF;"> 443</span><span style="color:#E6DB74;"> ssl</span><span style="color:#E6DB74;"> default_server</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#A6E22E;">    server_name</span><span style="color:#E6DB74;"> www.kana.com</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">     </span></span>
<span class="line"><span style="color:#A6E22E;">    ssl_protocols</span><span style="color:#E6DB74;"> TLSv1</span><span style="color:#E6DB74;"> TLSv1.1</span><span style="color:#E6DB74;"> TLSv1.2</span><span style="color:#E6DB74;"> TLSv1.3</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#A6E22E;">    ssl_ciphers</span><span style="color:#E6DB74;"> ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#A6E22E;">    ssl_prefer_server_ciphers</span><span style="color:#E6DB74;"> on</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E;">    ssl_certificate</span><span style="color:#E6DB74;"> /etc/nginx/certs/server/server.crt</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#A6E22E;">    ssl_certificate_key</span><span style="color:#E6DB74;"> /etc/nginx/certs/server/server.key</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E;">    location</span><span style="color:#E6DB74;"> /</span><span style="color:#E6DB74;"> {</span></span>
<span class="line"><span style="color:#A6E22E;">        default_type</span><span style="color:#E6DB74;"> text/plain</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F92672;">        return</span><span style="color:#AE81FF;"> 200</span><span style="color:#E6DB74;"> &quot;default page\\n&quot;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E;">    error_page</span><span style="color:#AE81FF;"> 497</span><span style="color:#E6DB74;">  https://</span><span style="color:#F8F8F2;">$host$request_uri;</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="æœåŠ¡ç«¯è¯ä¹¦å•å‘éªŒè¯" tabindex="-1">æœåŠ¡ç«¯è¯ä¹¦å•å‘éªŒè¯ <a class="header-anchor" href="#æœåŠ¡ç«¯è¯ä¹¦å•å‘éªŒè¯" aria-label="Permalink to â€œæœåŠ¡ç«¯è¯ä¹¦å•å‘éªŒè¯â€">â€‹</a></h2><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-30" id="tab-31" checked><label data-title="shell" for="tab-31">shell</label><input type="radio" name="group-30" id="tab-32"><label data-title="python" for="tab-32">python</label></div><div class="blocks"><div class="language-shell active line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#A6E22E;">curl</span><span style="color:#AE81FF;"> -vI</span><span style="color:#E6DB74;"> https://192.168.10.11:443/</span><span style="color:#AE81FF;"> --cacert</span><span style="color:#E6DB74;"> certs/ca/ca.crt</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> requests</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">if</span><span style="color:#F8F8F2;"> __name__ </span><span style="color:#F92672;">==</span><span style="color:#E6DB74;"> &#39;__main__&#39;</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">    url </span><span style="color:#F92672;">=</span><span style="color:#E6DB74;"> &quot;https://192.168.10.11:443/&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">    resp </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> requests.get(</span><span style="color:#FD971F;font-style:italic;">url</span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;">url, </span><span style="color:#FD971F;font-style:italic;">verify</span><span style="color:#F92672;">=</span><span style="color:#E6DB74;">&#39;certs/ca/ca.crt&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#66D9EF;">    print</span><span style="color:#F8F8F2;">(resp.status_code)</span></span>
<span class="line"><span style="color:#66D9EF;">    print</span><span style="color:#F8F8F2;">(resp.content)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></div></div><h2 id="æœåŠ¡ç«¯å®¢æˆ·ç«¯è¯ä¹¦åŒå‘éªŒè¯" tabindex="-1">æœåŠ¡ç«¯å®¢æˆ·ç«¯è¯ä¹¦åŒå‘éªŒè¯ <a class="header-anchor" href="#æœåŠ¡ç«¯å®¢æˆ·ç«¯è¯ä¹¦åŒå‘éªŒè¯" aria-label="Permalink to â€œæœåŠ¡ç«¯å®¢æˆ·ç«¯è¯ä¹¦åŒå‘éªŒè¯â€">â€‹</a></h2><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-37" id="tab-38" checked><label data-title="shell" for="tab-38">shell</label><input type="radio" name="group-37" id="tab-39"><label data-title="python" for="tab-39">python</label></div><div class="blocks"><div class="language-shell active line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#A6E22E;">curl</span><span style="color:#AE81FF;"> -vI</span><span style="color:#E6DB74;"> https://192.168.10.11:443/</span><span style="color:#AE81FF;"> --cacert</span><span style="color:#E6DB74;"> certs/ca/ca.crt</span><span style="color:#AE81FF;"> --cert</span><span style="color:#E6DB74;"> certs/client/client.crt</span><span style="color:#AE81FF;"> --key</span><span style="color:#E6DB74;"> certs/client/client.key</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> requests</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">if</span><span style="color:#F8F8F2;"> __name__ </span><span style="color:#F92672;">==</span><span style="color:#E6DB74;"> &#39;__main__&#39;</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">    url </span><span style="color:#F92672;">=</span><span style="color:#E6DB74;"> &quot;https://192.168.10.11:443/&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">    resp </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> requests.get(</span><span style="color:#FD971F;font-style:italic;">url</span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;">url,</span></span>
<span class="line"><span style="color:#FD971F;font-style:italic;">                        verify</span><span style="color:#F92672;">=</span><span style="color:#E6DB74;">&#39;certs/ca/ca.crt&#39;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#FD971F;font-style:italic;">                        cert</span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;certs/client/client.crt&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#E6DB74;">&#39;certs/client/client.key&#39;</span><span style="color:#F8F8F2;">))</span></span>
<span class="line"><span style="color:#66D9EF;">    print</span><span style="color:#F8F8F2;">(resp.status_code)</span></span>
<span class="line"><span style="color:#66D9EF;">    print</span><span style="color:#F8F8F2;">(resp.content)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></div></div>`,14)])])}const d=n(p,[["render",r]]);export{b as __pageData,d as default};
