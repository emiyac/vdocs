import{_ as s,o as n,c as a,Q as l}from"./chunks/framework.eabe3503.js";const u=JSON.parse('{"title":"管理arp表","description":"","frontmatter":{"title":"管理arp表","createTime":"2024/05/07 20:01:02","updateTime":"2024/05/07 21:01:02","isPublished":true},"headers":[],"relativePath":"linux/00301_arp_tutorial.md","filePath":"linux/00301_arp_tutorial.md"}'),e={name:"linux/00301_arp_tutorial.md"},p=l(`<h2 id="管理arp表" tabindex="-1">管理arp表 <a class="header-anchor" href="#管理arp表" aria-label="Permalink to &quot;管理arp表&quot;">​</a></h2><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>😂 当被<code>arp</code>攻击或者发现同一网段中的设备不能正常进行网络通信时，可以检查arp表是否正常</p></div><h3 id="查看arp记录" tabindex="-1">查看arp记录 <a class="header-anchor" href="#查看arp记录" aria-label="Permalink to &quot;查看arp记录&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 使用BSD样式输出</span></span>
<span class="line"><span style="color:#FFCB6B;">arp</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-an</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># ? (192.168.10.2) at 00:50:56:fa:cc:9b [ether] on ens33</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># ? (192.168.10.1) at 00:50:56:c0:00:08 [ether] on ens33</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 使用Linux样式输出</span></span>
<span class="line"><span style="color:#FFCB6B;">arp</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-en</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Address              HWtype  HWaddress           Flags Mask        Iface</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 192.168.10.2         ether   00:50:56:fa:cc:9b   C                 ens33</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 192.168.10.1         ether   00:50:56:c0:00:08   C                 ens33</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><table><thead><tr><th style="text-align:left;">Flags Mask</th><th style="text-align:left;">备注</th></tr></thead><tbody><tr><td style="text-align:left;">C</td><td style="text-align:left;">表示该条目是有效的</td></tr><tr><td style="text-align:left;">M</td><td style="text-align:left;">表示该条目是静态的，不会更新</td></tr></tbody></table><h3 id="添加arp记录" tabindex="-1">添加arp记录 <a class="header-anchor" href="#添加arp记录" aria-label="Permalink to &quot;添加arp记录&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 添加一条临时记录</span></span>
<span class="line"><span style="color:#FFCB6B;">arp</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-i</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">ens33</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-s</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">192.168</span><span style="color:#C3E88D;">.10.31</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">00</span><span style="color:#C3E88D;">:50:56:c0:00:11</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">temp</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 添加一条永久记录</span></span>
<span class="line"><span style="color:#FFCB6B;">arp</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-i</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">ens33</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-s</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">192.168</span><span style="color:#C3E88D;">.10.32</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">00</span><span style="color:#C3E88D;">:50:56:c0:00:12</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">arp</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-en</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Address              HWtype  HWaddress           Flags Mask        Iface</span></span>
<span class="line highlighted"><span style="color:#676E95;font-style:italic;"># 192.168.10.31        ether   00:50:56:c0:00:11   C                 ens33</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 192.168.10.2         ether   00:50:56:fa:cc:9b   C                 ens33</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 192.168.10.1         ether   00:50:56:c0:00:08   C                 ens33</span></span>
<span class="line highlighted"><span style="color:#676E95;font-style:italic;"># 192.168.10.32        ether   00:50:56:c0:00:12   CM                ens33</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="删除arp记录" tabindex="-1">删除arp记录 <a class="header-anchor" href="#删除arp记录" aria-label="Permalink to &quot;删除arp记录&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">arp</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-i</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">ens33</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-d</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">192.168</span><span style="color:#C3E88D;">.10.31</span></span>
<span class="line"><span style="color:#FFCB6B;">arp</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-en</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Address              HWtype  HWaddress           Flags Mask        Iface</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 192.168.10.2         ether   00:50:56:fa:cc:9b   C                 ens33</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 192.168.10.1         ether   00:50:56:c0:00:08   C                 ens33</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 192.168.10.32        ether   00:50:56:c0:00:12   CM                ens33</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="使用配置文件" tabindex="-1">使用配置文件 <a class="header-anchor" href="#使用配置文件" aria-label="Permalink to &quot;使用配置文件&quot;">​</a></h3><p>默认的配置文件是<code>/etc/ethers</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">cat</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&gt;&gt;</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/etc/ethers</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&lt;&lt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">EOF</span></span>
<span class="line"><span style="color:#C3E88D;">00:50:56:c0:00:13 192.168.10.33</span></span>
<span class="line"><span style="color:#C3E88D;">00:50:56:c0:00:14 192.168.10.34 temp</span></span>
<span class="line"><span style="color:#89DDFF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 执行命令行是配置文件生效</span></span>
<span class="line"><span style="color:#FFCB6B;">arp</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-f</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="使用arping探测目标物理地址" tabindex="-1">使用arping探测目标物理地址 <a class="header-anchor" href="#使用arping探测目标物理地址" aria-label="Permalink to &quot;使用arping探测目标物理地址&quot;">​</a></h3><p>发送<code>arp request</code>并接收响应</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">arping</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-I</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">ens33</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-c</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">1</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-w</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">3</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">192.168</span><span style="color:#C3E88D;">.10.11</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># ARPING 192.168.10.11 from 192.168.10.100 ens33</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Unicast reply from 192.168.10.11 [00:0C:29:A3:E6:77]  0.819ms</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Sent 1 probes (1 broadcast(s))</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Received 1 response(s)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 服务端tcpdump抓包</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># ARP, Ethernet (len 6), IPv4 (len 4), Request who-has 192.168.10.11 (Broadcast) tell 192.168.10.100, length 46</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># ARP, Ethernet (len 6), IPv4 (len 4), Reply 192.168.10.11 is-at 00:0c:29:a3:e6:77, length 28</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>⚡该命令行也可以探测局域网内是否有重复ip</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">arping</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-I</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">ens33</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">192.168</span><span style="color:#C3E88D;">.10.100</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-c</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">1</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-w</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">3</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># ARPING 192.168.10.100 from 192.168.10.10 ens33</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Unicast reply from 192.168.10.100 [00:0C:29:1E:1B:83]  0.758ms</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Unicast reply from 192.168.10.100 [00:0C:29:A3:E6:77]  0.871ms</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>发送<code>arp request</code>不接收<code>replay</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">arping</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-UI</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">ens33</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-c</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">1</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-w</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">3</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-s</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">192.168</span><span style="color:#C3E88D;">.10.100</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">192.168</span><span style="color:#C3E88D;">.10.11</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># ARPING 192.168.10.11 from 192.168.10.100 ens33</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Sent 1 probes (1 broadcast(s))</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Received 0 response(s)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 服务端tcpdump抓包</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># ARP, Ethernet (len 6), IPv4 (len 4), Request who-has 192.168.10.11 (Broadcast) tell 192.168.10.100, length 46</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># ARP, Ethernet (len 6), IPv4 (len 4), Reply 192.168.10.11 is-at 00:0c:29:a3:e6:77, length 28</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>只发送<code>arp replay</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">arping</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-AI</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">ens33</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-c</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">1</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-w</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">3</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-s</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">192.168</span><span style="color:#C3E88D;">.10.100</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">192.168</span><span style="color:#C3E88D;">.10.11</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># ARPING 192.168.10.11 from 192.168.10.100 ens33</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Sent 1 probes (1 broadcast(s))</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Received 0 response(s)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 服务端tcpdump抓包,可以看到只有arp replay数据包</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># ARP, Ethernet (len 6), IPv4 (len 4), Reply 192.168.10.100 is-at 00:0c:29:1e:1b:83, length 46</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div>`,21),t=[p];function o(r,c,i,y,b,d){return n(),a("div",null,t)}const B=s(e,[["render",o]]);export{u as __pageData,B as default};
