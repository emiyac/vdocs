import{_ as s,o as n,c as a,Q as l}from"./chunks/framework.eabe3503.js";const E=JSON.parse('{"title":"mysql双主模式部署","description":"","frontmatter":{"title":"mysql双主模式部署","createTime":"2024/03/21 15:29:31","updateTime":"2024/03/21 18:16:48","isPublished":true,"tags":["mysql"]},"headers":[],"relativePath":"middleware/00502_mysql_ha_cluster_tutorial.md","filePath":"middleware/00502_mysql_ha_cluster_tutorial.md"}'),p={name:"middleware/00502_mysql_ha_cluster_tutorial.md"},e=l(`<h2 id="环境说明" tabindex="-1">环境说明 <a class="header-anchor" href="#环境说明" aria-label="Permalink to &quot;环境说明&quot;">​</a></h2><table><thead><tr><th>role</th><th>ip</th><th>version</th></tr></thead><tbody><tr><td>master01</td><td>192.168.10.12</td><td>mysql-5.7.21 keepalived</td></tr><tr><td>master02</td><td>192.168.10.13</td><td>mysql-5.7.21 keepalived</td></tr><tr><td>vip</td><td>192.168.10.15</td><td></td></tr></tbody></table><h2 id="mysql初始化配置" tabindex="-1">mysql初始化配置 <a class="header-anchor" href="#mysql初始化配置" aria-label="Permalink to &quot;mysql初始化配置&quot;">​</a></h2><p>本次示例采用二进制的方式部署👉 <a href="https://downloads.mysql.com/archives/community/" target="_blank" rel="noreferrer">官网下载地址</a></p><p>⚡ <code>master01</code>和<code>master02</code>上都要执行</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># wget https://cdn.mysql.com/archives/mysql-5.7/mysql-5.7.21-linux-glibc2.12-x86_64.tar.gz</span></span>
<span class="line"><span style="color:#FFCB6B;">useradd</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">mysql</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-s</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/sbin/nologin</span></span>
<span class="line"><span style="color:#FFCB6B;">mkdir</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/workspace/mysql/{data,logs,temp}</span></span>
<span class="line"><span style="color:#FFCB6B;">chown</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">mysql.mysql</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-R</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/workspace/mysql</span></span>
<span class="line"><span style="color:#FFCB6B;">tar</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-zxvf</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">mysql-5.7.21-linux-glibc2.12-x86_64.tar.gz</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-C</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/opt/</span></span>
<span class="line"><span style="color:#FFCB6B;">ln</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-s</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/opt/mysql-5.7.21-linux-glibc2.12-x86_64</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/usr/local/mysql</span></span>
<span class="line"><span style="color:#FFCB6B;">ln</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-s</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/usr/local/mysql/lib</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/usr/lib/mysql</span></span>
<span class="line"><span style="color:#FFCB6B;">ln</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-s</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/usr/local/mysql/include/mysql</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/usr/include/mysql</span></span>
<span class="line"><span style="color:#FFCB6B;">ln</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-s</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/usr/local/mysql/bin/mysql</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/usr/local/bin/mysql</span></span>
<span class="line"><span style="color:#FFCB6B;">ln</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-s</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/usr/local/mysql/bin/mysqlbinlog</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/usr/local/bin/mysqlbinlog</span></span>
<span class="line"><span style="color:#FFCB6B;">ln</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-s</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/usr/local/mysql/bin/mysqldump</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/usr/local/bin/mysqldump</span></span>
<span class="line"><span style="color:#FFCB6B;">ln</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-s</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/usr/local/mysql/support-files/mysql.server</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/etc/init.d/mysqld</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="mysql节点配置" tabindex="-1">mysql节点配置 <a class="header-anchor" href="#mysql节点配置" aria-label="Permalink to &quot;mysql节点配置&quot;">​</a></h2><p>step01 修改<code>/etc/my.cnf</code>, master节点需要开启<code>binlog</code>,<code>gtid</code>,<code>relay log</code></p><p>⚡ <code>master01</code>和<code>master02</code>上都要执行，两个节点的<code>server-id</code>和<code>auto-increment-offset</code>要设置成不同的值</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">client</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#BABED8;">port</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">3306</span></span>
<span class="line"><span style="color:#BABED8;">socket</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">/workspace/mysql/logs/mysqld.sock</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">mysqld</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># server id需要唯一</span></span>
<span class="line highlighted"><span style="color:#BABED8;">server-id</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#BABED8;">port</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">3306</span></span>
<span class="line"><span style="color:#BABED8;">user</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">mysql</span></span>
<span class="line"><span style="color:#BABED8;">socket</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">/workspace/mysql/logs/mysqld.sock</span></span>
<span class="line"><span style="color:#BABED8;">pid-file</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">/workspace/mysql/logs/mysqld.pid</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">basedir</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">/usr/local/mysql</span></span>
<span class="line"><span style="color:#BABED8;">datadir</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">/workspace/mysql/data</span></span>
<span class="line"><span style="color:#BABED8;">tmpdir</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">/workspace/mysql/temp</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">default-storage-engine</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">INNODB</span></span>
<span class="line"><span style="color:#BABED8;">log-error</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">/workspace/mysql/logs/error.log</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">character-set-server</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">utf8mb4</span></span>
<span class="line"><span style="color:#BABED8;">collation-server</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">utf8mb4_unicode_ci</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">max-connections</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">200</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 开启binglog</span></span>
<span class="line"><span style="color:#BABED8;">log-bin</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">/workspace/mysql/logs/mysql-bin</span></span>
<span class="line"><span style="color:#BABED8;">sync-binlog</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 开启存储过程、函数、触发器等内容的同步功能</span></span>
<span class="line"><span style="color:#BABED8;">log-bin-trust-function-creators</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#BABED8;">binlog-format</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">ROW</span></span>
<span class="line"><span style="color:#BABED8;">max-binlog-size</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">256</span><span style="color:#C3E88D;">M</span></span>
<span class="line"><span style="color:#BABED8;">expire-logs-days</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">30</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 开启GTID复制,即slave同步时不需要设置master的binlog和position</span></span>
<span class="line"><span style="color:#BABED8;">gtid-mode</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">on</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 跳过一些可能导致执行出错的SQL语句</span></span>
<span class="line"><span style="color:#BABED8;">enforce-gtid-consistency</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 开启relay log</span></span>
<span class="line"><span style="color:#BABED8;">relay-log</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">/workspace/mysql/logs/relay-bin</span></span>
<span class="line"><span style="color:#BABED8;">relay-log-index</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">/workspace/mysql/logs/relay-bin.index</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 同步执行跳过一些错误码</span></span>
<span class="line"><span style="color:#BABED8;">slave-skip-errors</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1062</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 忽略同步库</span></span>
<span class="line"><span style="color:#BABED8;">replicate-ignore-db</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">mysql</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">replicate-ignore-db</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">information_schema</span></span>
<span class="line"><span style="color:#BABED8;">replicate-ignore-db</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">performance_schema</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 设置自增序列,2个节点的初始值即offset分为设置1,2</span></span>
<span class="line highlighted"><span style="color:#BABED8;">auto-increment-offset</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#BABED8;">auto-increment-increment</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br></div></div><p>step02 初始化数据库，并启动<code>mysqld</code>服务</p><p>⚡ <code>master01</code>和<code>master02</code>上都要执行</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">/usr/local/mysql/bin/mysqld</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--initialize-insecure</span></span>
<span class="line"><span style="color:#FFCB6B;">chkconfig</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--add</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">mysqld</span></span>
<span class="line"><span style="color:#FFCB6B;">chkconfig</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">mysqld</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">on</span></span>
<span class="line"><span style="color:#FFCB6B;">service</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">mysqld</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">start</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>step03 设置<code>mysql</code>的<code>root</code>密码，并创建用于同步数据的账号<code>repl</code></p><p>⚡ 只在<code>master01</code>上执行</p><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">alter</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">user</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">root</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">@</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">localhost</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> identified </span><span style="color:#F78C6C;">with</span><span style="color:#BABED8;"> mysql_native_password </span><span style="color:#F78C6C;">by</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">root</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">user</span><span style="color:#BABED8;"> &quot;</span><span style="color:#82AAFF;">repl</span><span style="color:#BABED8;">&quot;@</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">192.168.10.%</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> identified </span><span style="color:#F78C6C;">by</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">testfind</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">grant</span><span style="color:#BABED8;"> replication slave </span><span style="color:#F78C6C;">on</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">*</span><span style="color:#BABED8;">.</span><span style="color:#89DDFF;">*</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">to</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">repl</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">@</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">192.168.10.%</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">flush privileges;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="设置主从同步" tabindex="-1">设置主从同步 <a class="header-anchor" href="#设置主从同步" aria-label="Permalink to &quot;设置主从同步&quot;">​</a></h2><p>双主模式即两个节点互为主从</p><p>⚡ 在<code>master02</code>上执行</p><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- master02上执行命令行，将master01设置为自己的主机点</span></span>
<span class="line"><span style="color:#BABED8;">change </span><span style="color:#F78C6C;">master</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">to</span><span style="color:#BABED8;"> master_host</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">192.168.10.12</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">,master_user</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">repl</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">, master_password</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">testfind</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">,master_port</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">3306</span><span style="color:#BABED8;">,master_auto_position</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span><span style="color:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">-- 开启slave同步线程</span></span>
<span class="line"><span style="color:#F78C6C;">start</span><span style="color:#BABED8;"> slave;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">-- 查看slave节点连接状态，主要关注 Slave_IO_Running 和 Slave_SQL_Running 的值</span></span>
<span class="line"><span style="color:#BABED8;">show slave </span><span style="color:#F78C6C;">status</span><span style="color:#BABED8;"> \\G;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>⚡ 在<code>master01</code>上执行</p><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- master01上执行命令行，将master02设置为自己的主机点</span></span>
<span class="line"><span style="color:#BABED8;">change </span><span style="color:#F78C6C;">master</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">to</span><span style="color:#BABED8;"> master_host</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">192.168.10.13</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">,master_user</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">repl</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">, master_password</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">testfind</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">,master_port</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">3306</span><span style="color:#BABED8;">,master_auto_position</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span><span style="color:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">-- 开启slave同步线程</span></span>
<span class="line"><span style="color:#F78C6C;">start</span><span style="color:#BABED8;"> slave;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">-- 查看slave节点连接状态，主要关注 Slave_IO_Running 和 Slave_SQL_Running 的值</span></span>
<span class="line"><span style="color:#BABED8;">show slave </span><span style="color:#F78C6C;">status</span><span style="color:#BABED8;"> \\G;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="测试数据同步" tabindex="-1">测试数据同步 <a class="header-anchor" href="#测试数据同步" aria-label="Permalink to &quot;测试数据同步&quot;">​</a></h2><p>⚡ 在其中一个节点上创建数据库、表并且插入数据</p><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">create</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">database</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">if</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">not</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">exists</span><span style="color:#BABED8;"> db01;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">use</span><span style="color:#BABED8;"> db01;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">table</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">if</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">not</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">exists</span><span style="color:#BABED8;"> tb01(id </span><span style="color:#C792EA;">int</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">primary key</span><span style="color:#BABED8;">, </span><span style="color:#F78C6C;">data</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">varchar</span><span style="color:#BABED8;">(</span><span style="color:#F78C6C;">32</span><span style="color:#BABED8;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">insert into</span><span style="color:#BABED8;"> tb01 </span><span style="color:#F78C6C;">values</span><span style="color:#BABED8;">(</span><span style="color:#F78C6C;">1</span><span style="color:#BABED8;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">tom</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">),(</span><span style="color:#F78C6C;">2</span><span style="color:#BABED8;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">jerry</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>⚡ 在另一个节点上查看是否有数据</p><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">select</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">*</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">from</span><span style="color:#BABED8;"> db01.tb01;</span></span>
<span class="line"><span style="color:#BABED8;"># </span><span style="color:#89DDFF;">+</span><span style="color:#676E95;font-style:italic;">----+-------+</span></span>
<span class="line"><span style="color:#BABED8;"># | id | </span><span style="color:#F78C6C;">data</span><span style="color:#BABED8;">  |</span></span>
<span class="line"><span style="color:#BABED8;"># </span><span style="color:#89DDFF;">+</span><span style="color:#676E95;font-style:italic;">----+-------+</span></span>
<span class="line"><span style="color:#BABED8;"># |  </span><span style="color:#F78C6C;">1</span><span style="color:#BABED8;"> | tom   |</span></span>
<span class="line"><span style="color:#BABED8;"># |  </span><span style="color:#F78C6C;">2</span><span style="color:#BABED8;"> | jerry |</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="安装keepalived" tabindex="-1">安装keepalived <a class="header-anchor" href="#安装keepalived" aria-label="Permalink to &quot;安装keepalived&quot;">​</a></h2><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">install</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-y</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">keepalived</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="keepalived配置" tabindex="-1">keepalived配置 <a class="header-anchor" href="#keepalived配置" aria-label="Permalink to &quot;keepalived配置&quot;">​</a></h3><p>⚡ <code>master01</code>节点<code>/etc/keepalived/keepalived.conf</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#FFCB6B;">global_defs</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line highlighted"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">router_id</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">master01</span></span>
<span class="line"><span style="color:#BABED8;">}</span></span>
<span class="line"><span style="color:#FFCB6B;">vrrp_script</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">check_mysqld</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">script</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">service mysqld status</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">interval</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">2</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">weight</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-2</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">timeout</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">fall</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">2</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">rise</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">2</span></span>
<span class="line"><span style="color:#BABED8;">}</span></span>
<span class="line"><span style="color:#FFCB6B;">vrrp_instance</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">VI_1</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line highlighted"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">state</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">MASTER</span><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">#设置为主服务器</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">interface</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">ens33</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">#监测网络接口</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">virtual_router_id</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">200</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">#主、备必须一样</span></span>
<span class="line highlighted"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">priority</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">100</span><span style="color:#BABED8;">   </span><span style="color:#676E95;font-style:italic;">#(主、备机取不同的优先级，主机值较大，备份机值较小,值越大优先级越高)</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">advert_int</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">1</span><span style="color:#BABED8;">   </span><span style="color:#676E95;font-style:italic;">#VRRP Multicast广播周期秒数</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">authentication</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#BABED8;">       </span><span style="color:#FFCB6B;">auth_type</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">PASS</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">#VRRP认证方式，主备必须一致</span></span>
<span class="line"><span style="color:#BABED8;">       </span><span style="color:#FFCB6B;">auth_pass</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">testfind</span><span style="color:#BABED8;">   </span><span style="color:#676E95;font-style:italic;">#(密码)</span></span>
<span class="line"><span style="color:#BABED8;">    }</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">virtual_ipaddress</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#BABED8;">       </span><span style="color:#FFCB6B;">192.168.10.15</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">#VRRP HA虚拟地址</span></span>
<span class="line"><span style="color:#BABED8;">    }</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">track_script</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#FFCB6B;">check_mysqld</span></span>
<span class="line"><span style="color:#BABED8;">    }</span></span>
<span class="line"><span style="color:#BABED8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>⚡ <code>master02</code>节点<code>/etc/keepalived/keepalived.conf</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#FFCB6B;">global_defs</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line highlighted"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">router_id</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">master02</span></span>
<span class="line"><span style="color:#BABED8;">}</span></span>
<span class="line"><span style="color:#FFCB6B;">vrrp_script</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">check_mysqld</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">script</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">service mysqld status</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">interval</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">2</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">weight</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-2</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">timeout</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">fall</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">2</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">rise</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">2</span></span>
<span class="line"><span style="color:#BABED8;">}</span></span>
<span class="line"><span style="color:#FFCB6B;">vrrp_instance</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">VI_1</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line highlighted"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">state</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">BACKUP</span><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">#设置为主服务器</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">interface</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">ens33</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">#监测网络接口</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">virtual_router_id</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">200</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">#主、备必须一样</span></span>
<span class="line highlighted"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">priority</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">99</span><span style="color:#BABED8;">   </span><span style="color:#676E95;font-style:italic;">#(主、备机取不同的优先级，主机值较大，备份机值较小,值越大优先级越高)</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">advert_int</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">1</span><span style="color:#BABED8;">   </span><span style="color:#676E95;font-style:italic;">#VRRP Multicast广播周期秒数</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">authentication</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#BABED8;">       </span><span style="color:#FFCB6B;">auth_type</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">PASS</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">#VRRP认证方式，主备必须一致</span></span>
<span class="line"><span style="color:#BABED8;">       </span><span style="color:#FFCB6B;">auth_pass</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">testfind</span><span style="color:#BABED8;">   </span><span style="color:#676E95;font-style:italic;">#(密码)</span></span>
<span class="line"><span style="color:#BABED8;">    }</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">virtual_ipaddress</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#BABED8;">       </span><span style="color:#FFCB6B;">192.168.10.15</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">#VRRP HA虚拟地址</span></span>
<span class="line"><span style="color:#BABED8;">    }</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">track_script</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#FFCB6B;">check_mysqld</span></span>
<span class="line"><span style="color:#BABED8;">    }</span></span>
<span class="line"><span style="color:#BABED8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>⚡ 启动<code>keepalived</code>服务并设置开机自启</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">enable</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--now</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">keepalived</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="测试验证" tabindex="-1">测试验证 <a class="header-anchor" href="#测试验证" aria-label="Permalink to &quot;测试验证&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">#在master01节点上停止mysql服务</span></span>
<span class="line"><span style="color:#FFCB6B;">service</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">mysqld</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">stop</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 查看网卡ip</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 查看keepalived服务日志，可以发现master01节点健康检查失败，优先级降低，已经切换为BACKUP</span></span>
<span class="line"><span style="color:#FFCB6B;">journalctl</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-u</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">keepalived</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--since</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2 min ago</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Keepalived_vrrp[7233]: /usr/sbin/service mysqld status exited with status 3</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Keepalived_vrrp[7233]: /usr/sbin/service mysqld status exited with status 3</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Keepalived_vrrp[7233]: VRRP_Script(check_mysqld) failed</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Keepalived_vrrp[7233]: VRRP_Instance(VI_1) Changing effective priority from 100 to 98</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Keepalived_vrrp[7233]: VRRP_Instance(VI_1) Received advert with higher priority 99, ours 98</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Keepalived_vrrp[7233]: VRRP_Instance(VI_1) Entering BACKUP STATE</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Keepalived_vrrp[7233]: VRRP_Instance(VI_1) removing protocol VIPs.</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Keepalived_vrrp[7233]: /usr/sbin/service mysqld status exited with status 3</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 在master01节点上启动mysql服务</span></span>
<span class="line"><span style="color:#FFCB6B;">service</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">mysqld</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">start</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 查看keepalived服务日志，可以发现master01节点健康检查成功，优先级恢复，已经切换为MASTER</span></span>
<span class="line"><span style="color:#FFCB6B;">journalctl</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-u</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">keepalived</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--since</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2 min ago</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Keepalived_vrrp[7233]: /usr/sbin/service mysqld status exited with status 3</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Keepalived_vrrp[7233]: VRRP_Script(check_mysqld) succeeded</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Keepalived_vrrp[7233]: VRRP_Instance(VI_1) Changing effective priority from 98 to 100</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Keepalived_vrrp[7233]: VRRP_Instance(VI_1) forcing a new MASTER election</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Keepalived_vrrp[7233]: VRRP_Instance(VI_1) Transition to MASTER STATE</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Keepalived_vrrp[7233]: VRRP_Instance(VI_1) Entering MASTER STATE</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Keepalived_vrrp[7233]: VRRP_Instance(VI_1) setting protocol VIPs.</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Keepalived_vrrp[7233]: Sending gratuitous ARP on ens33 for 192.168.10.15</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Keepalived_vrrp[7233]: VRRP_Instance(VI_1) Sending/queueing gratuitous ARPs on ens33 for 192.168.10.15</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div>`,38),o=[e];function r(c,t,i,y,B,D){return n(),a("div",null,o)}const m=s(p,[["render",r]]);export{E as __pageData,m as default};
