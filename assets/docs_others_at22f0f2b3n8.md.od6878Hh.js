import{_ as n,a,o as l,a3 as p}from"./chunks/framework.dRMRuUHH.js";const b=JSON.parse('{"title":"ç²¾ç®€å’Œè½¬æ¢å­—ä½“æ–‡ä»¶","description":"","frontmatter":{"id":3006,"title":"ç²¾ç®€å’Œè½¬æ¢å­—ä½“æ–‡ä»¶","createTime":"2025-12-01 17:34:40","category":"others"},"headers":[],"relativePath":"docs/others/at22f0f2b3n8.md","filePath":"docs/others/0006_python_sub_ttf.md"}'),o={name:"docs/others/at22f0f2b3n8.md"};function e(t,s,F,c,r,i){return l(),a("div",null,[...s[0]||(s[0]=[p(`<h2 id="é¡»çŸ¥" tabindex="-1">é¡»çŸ¥ <a class="header-anchor" href="#é¡»çŸ¥" aria-label="Permalink to â€œé¡»çŸ¥â€">â€‹</a></h2><div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>ä½¿ç”¨<code>python</code>è„šæœ¬ï¼Œå¹¶åˆ‡éœ€è¦å®‰è£…ç¬¬ä¸‰æ–¹åº“<code>pip install fonttools==4.57.0 brotli==1.1.0</code></p></div><p>ğŸ‘‰<a href="https://gist.githubusercontent.com/imaegoo/d64e5088b723c2e02c40985f55ff12db/raw/5ebd2ce49418c73459a9dfe050483409306a6c1d/sc_unicode.txt" target="_blank" rel="noreferrer">ç®€ä½“ä¸­æ–‡unicodeæ–‡ä»¶ä¸‹è½½åœ°å€</a></p><p><code>sub_convert_font.py</code>è„šæœ¬å†…å®¹å¦‚ä¸‹</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#F92672;">from</span><span style="color:#F8F8F2;"> fontTools.ttLib </span><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> TTFont</span></span>
<span class="line"><span style="color:#F92672;">from</span><span style="color:#F8F8F2;"> fontTools.subset </span><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> Subsetter, Options</span></span>
<span class="line"><span style="color:#F92672;">from</span><span style="color:#F8F8F2;"> fontTools.ttLib </span><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> TTFont</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">class</span><span> </span><span style="color:#A6E22E;text-decoration:underline;">MyTTF</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">    def</span><span style="color:#66D9EF;"> __init__</span><span style="color:#F8F8F2;">(</span><span style="color:#FD971F;font-style:italic;">self</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F92672;">        pass</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E;">    @</span><span style="color:#66D9EF;font-style:italic;">staticmethod</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">    def</span><span style="color:#A6E22E;"> get_chars_from_unicode</span><span style="color:#F8F8F2;">(</span><span style="color:#FD971F;font-style:italic;">unicode_file</span><span style="color:#F8F8F2;">: </span><span style="color:#66D9EF;font-style:italic;">str</span><span style="color:#F92672;"> =</span><span style="color:#E6DB74;"> &#39;sc_unicode.txt&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#FD971F;font-style:italic;">latin</span><span style="color:#F92672;">=</span><span style="color:#AE81FF;">False</span><span style="color:#F8F8F2;">, </span><span style="color:#FD971F;font-style:italic;">chinese_characters</span><span style="color:#F92672;">=</span><span style="color:#AE81FF;">False</span><span style="color:#F8F8F2;">, </span><span style="color:#FD971F;font-style:italic;">chinese_simplified</span><span style="color:#F92672;">=</span><span style="color:#AE81FF;">False</span><span style="color:#F8F8F2;">) -&gt; </span><span style="color:#66D9EF;font-style:italic;">list</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#E6DB74;">        &quot;&quot;&quot; ä»ç®€ä½“ä¸­æ–‡unicodeæ–‡ä»¶ä¸­è·å–å­—ç¬¦é›† &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#66D9EF;">        print</span><span style="color:#F8F8F2;">(</span><span style="color:#66D9EF;font-style:italic;">f</span><span style="color:#E6DB74;">&#39;æ­£åœ¨è§£æUnicodeå­—ç¬¦é›†, æ–‡ä»¶: </span><span style="color:#AE81FF;">{</span><span style="color:#F8F8F2;">unicode_file</span><span style="color:#AE81FF;">}</span><span style="color:#E6DB74;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">        keys </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> [</span><span style="color:#E6DB74;">&#39;Latin&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#E6DB74;">&#39;Chinese Characters&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#E6DB74;">&#39;Chinese Simplified&#39;</span><span style="color:#F8F8F2;">]</span></span>
<span class="line"><span style="color:#F8F8F2;">        temp </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> {}</span></span>
<span class="line"><span style="color:#F8F8F2;">        data </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> []</span></span>
<span class="line"><span style="color:#F92672;">        with</span><span style="color:#66D9EF;"> open</span><span style="color:#F8F8F2;">(unicode_file, </span><span style="color:#E6DB74;">&#39;r&#39;</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">as</span><span style="color:#F8F8F2;"> f:</span></span>
<span class="line"><span style="color:#F8F8F2;">            lines </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> f.readlines()</span></span>
<span class="line"><span style="color:#F92672;">        for</span><span style="color:#F8F8F2;"> line </span><span style="color:#F92672;">in</span><span style="color:#F8F8F2;"> lines:</span></span>
<span class="line"><span style="color:#F92672;">            if</span><span style="color:#F8F8F2;"> line.startswith(</span><span style="color:#E6DB74;">&#39;#&#39;</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F92672;">                for</span><span style="color:#F8F8F2;"> _key </span><span style="color:#F92672;">in</span><span style="color:#F8F8F2;"> keys:</span></span>
<span class="line"><span style="color:#F92672;">                    if</span><span style="color:#F8F8F2;"> _key </span><span style="color:#F92672;">in</span><span style="color:#F8F8F2;"> line:</span></span>
<span class="line"><span style="color:#F8F8F2;">                        key </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> _key</span></span>
<span class="line"><span style="color:#F8F8F2;">                        temp[key]</span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;">[]</span></span>
<span class="line"><span style="color:#F92672;">                        break</span></span>
<span class="line"><span style="color:#F92672;">            else</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F92672;">                if</span><span style="color:#E6DB74;"> &#39;-&#39;</span><span style="color:#F92672;"> in</span><span style="color:#F8F8F2;"> line:</span></span>
<span class="line"><span style="color:#F8F8F2;">                    start, end </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> line.split(</span><span style="color:#E6DB74;">&#39;-&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">                    start </span><span style="color:#F92672;">=</span><span style="color:#66D9EF;font-style:italic;"> int</span><span style="color:#F8F8F2;">(start, </span><span style="color:#AE81FF;">16</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">                    end </span><span style="color:#F92672;">=</span><span style="color:#66D9EF;font-style:italic;"> int</span><span style="color:#F8F8F2;">(end, </span><span style="color:#AE81FF;">16</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F92672;">                    for</span><span style="color:#F8F8F2;"> i </span><span style="color:#F92672;">in</span><span style="color:#66D9EF;"> range</span><span style="color:#F8F8F2;">(start, end </span><span style="color:#F92672;">+</span><span style="color:#AE81FF;"> 1</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">                        temp[key].append(i)</span></span>
<span class="line"><span style="color:#F92672;">                else</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">                    temp[key].append(</span><span style="color:#66D9EF;font-style:italic;">int</span><span style="color:#F8F8F2;">(line, </span><span style="color:#AE81FF;">16</span><span style="color:#F8F8F2;">))</span></span>
<span class="line"><span style="color:#F92672;">        if</span><span style="color:#F8F8F2;"> latin:</span></span>
<span class="line"><span style="color:#F8F8F2;">            data.extend(temp[</span><span style="color:#E6DB74;">&#39;Latin&#39;</span><span style="color:#F8F8F2;">])</span></span>
<span class="line"><span style="color:#F92672;">        if</span><span style="color:#F8F8F2;"> chinese_characters:</span></span>
<span class="line"><span style="color:#F8F8F2;">            data.extend(temp[</span><span style="color:#E6DB74;">&#39;Chinese Characters&#39;</span><span style="color:#F8F8F2;">])</span></span>
<span class="line"><span style="color:#F92672;">        if</span><span style="color:#F8F8F2;"> chinese_simplified:</span></span>
<span class="line"><span style="color:#F8F8F2;">            data.extend(temp[</span><span style="color:#E6DB74;">&#39;Chinese Simplified&#39;</span><span style="color:#F8F8F2;">])</span></span>
<span class="line"><span style="color:#F8F8F2;">        data </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> [</span><span style="color:#66D9EF;">chr</span><span style="color:#F8F8F2;">(c) </span><span style="color:#F92672;">for</span><span style="color:#F8F8F2;"> c </span><span style="color:#F92672;">in</span><span style="color:#F8F8F2;"> data]</span></span>
<span class="line"><span style="color:#66D9EF;">        print</span><span style="color:#F8F8F2;">(</span><span style="color:#66D9EF;font-style:italic;">f</span><span style="color:#E6DB74;">&#39;è·å¾—å­—ç¬¦é›†</span><span style="color:#AE81FF;">{</span><span style="color:#F8F8F2;">data.</span><span style="color:#66D9EF;">__len__</span><span style="color:#F8F8F2;">()</span><span style="color:#AE81FF;">}</span><span style="color:#E6DB74;">ä¸ª&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F92672;">        return</span><span style="color:#F8F8F2;"> data</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E;">    @</span><span style="color:#66D9EF;font-style:italic;">staticmethod</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">    def</span><span style="color:#A6E22E;"> subset</span><span style="color:#F8F8F2;">(</span><span style="color:#FD971F;font-style:italic;">sfile</span><span style="color:#F8F8F2;">: </span><span style="color:#66D9EF;font-style:italic;">str</span><span style="color:#F8F8F2;">, </span><span style="color:#FD971F;font-style:italic;">chars</span><span style="color:#F8F8F2;">: </span><span style="color:#66D9EF;font-style:italic;">set</span><span style="color:#F92672;"> =</span><span style="color:#F8F8F2;"> {}, </span><span style="color:#FD971F;font-style:italic;">covert_woff2</span><span style="color:#F8F8F2;">: </span><span style="color:#66D9EF;font-style:italic;">bool</span><span style="color:#F92672;"> =</span><span style="color:#AE81FF;"> True</span><span style="color:#F8F8F2;">) -&gt; </span><span style="color:#AE81FF;">None</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#E6DB74;">        &quot;&quot;&quot; ä» &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#66D9EF;">        print</span><span style="color:#F8F8F2;">(</span><span style="color:#66D9EF;font-style:italic;">f</span><span style="color:#E6DB74;">&#39;æ­£åœ¨åŠ è½½æº, æºæ–‡ä»¶: </span><span style="color:#AE81FF;">{</span><span style="color:#F8F8F2;">sfile</span><span style="color:#AE81FF;">}</span><span style="color:#E6DB74;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">        ttf_file </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> sfile.split(</span><span style="color:#E6DB74;">&#39;.&#39;</span><span style="color:#F8F8F2;">)[</span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">] </span><span style="color:#F92672;">+</span><span style="color:#E6DB74;"> &#39;_sub.ttf&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">        woff2_file </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> sfile.split(</span><span style="color:#E6DB74;">&#39;.&#39;</span><span style="color:#F8F8F2;">)[</span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">] </span><span style="color:#F92672;">+</span><span style="color:#E6DB74;"> &#39;_sub.woff2&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">        font </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> TTFont(sfile)</span></span>
<span class="line"><span style="color:#88846F;">        # é…ç½®å­é›†åŒ–é€‰é¡¹</span></span>
<span class="line"><span style="color:#F8F8F2;">        options </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> Options()</span></span>
<span class="line"><span style="color:#F8F8F2;">        options.desubroutinize </span><span style="color:#F92672;">=</span><span style="color:#AE81FF;"> True</span><span style="color:#88846F;">  # ç®€åŒ–å­—å½¢æ•°æ®ï¼ˆæå‡å…¼å®¹æ€§ï¼‰</span></span>
<span class="line"><span style="color:#F8F8F2;">        options.drop_tables </span><span style="color:#F92672;">+=</span><span style="color:#F8F8F2;"> [</span><span style="color:#E6DB74;">&#39;DSIG&#39;</span><span style="color:#F8F8F2;">]  </span><span style="color:#88846F;"># ç§»é™¤æ•°å­—ç­¾åè¡¨ï¼ˆå¯é€‰ï¼‰</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span></span>
<span class="line"><span style="color:#88846F;">        # åˆå§‹åŒ–å­é›†å·¥å…·</span></span>
<span class="line"><span style="color:#F8F8F2;">        subsetter </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> Subsetter(</span><span style="color:#FD971F;font-style:italic;">options</span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;">options)</span></span>
<span class="line"><span style="color:#F8F8F2;">        subsetter.populate(</span><span style="color:#FD971F;font-style:italic;">text</span><span style="color:#F92672;">=</span><span style="color:#E6DB74;">&#39;&#39;</span><span style="color:#F8F8F2;">.join(chars))  </span><span style="color:#88846F;"># è®¾ç½®ä¿ç•™çš„å­—ç¬¦</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span></span>
<span class="line"><span style="color:#88846F;">        # åº”ç”¨å­é›†åŒ–</span></span>
<span class="line"><span style="color:#F8F8F2;">        subsetter.subset(font)</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span></span>
<span class="line"><span style="color:#88846F;">        # ä¿å­˜ç²¾ç®€åçš„å­—ä½“</span></span>
<span class="line"><span style="color:#F8F8F2;">        font.save(ttf_file)</span></span>
<span class="line"><span style="color:#66D9EF;">        print</span><span style="color:#F8F8F2;">(</span><span style="color:#66D9EF;font-style:italic;">f</span><span style="color:#E6DB74;">&quot;ç²¾ç®€åçš„å­—ä½“å·²ä¿å­˜è‡³: </span><span style="color:#AE81FF;">{</span><span style="color:#F8F8F2;">ttf_file</span><span style="color:#AE81FF;">}</span><span style="color:#E6DB74;">&quot;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">        if</span><span style="color:#F8F8F2;"> covert_woff2:</span></span>
<span class="line"><span style="color:#88846F;">            # ttfè½¬woff2</span></span>
<span class="line"><span style="color:#F8F8F2;">            font </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> TTFont(ttf_file)</span></span>
<span class="line"><span style="color:#F8F8F2;">            font.flavor </span><span style="color:#F92672;">=</span><span style="color:#E6DB74;"> &quot;woff2&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">            font.save(woff2_file)</span></span>
<span class="line"><span style="color:#66D9EF;">            print</span><span style="color:#F8F8F2;">(</span><span style="color:#66D9EF;font-style:italic;">f</span><span style="color:#E6DB74;">&quot;è½¬æ¢åçš„WOFF2å­—ä½“å·²ä¿å­˜è‡³: </span><span style="color:#AE81FF;">{</span><span style="color:#F8F8F2;">woff2_file</span><span style="color:#AE81FF;">}</span><span style="color:#E6DB74;">&quot;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">if</span><span style="color:#F8F8F2;"> __name__ </span><span style="color:#F92672;">==</span><span style="color:#E6DB74;"> &#39;__main__&#39;</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#88846F;">    # åŸºäºsc_unicode.txtæå–ä¸­æ–‡å­—ç¬¦é›†å¹¶ç”Ÿæˆå­—ä½“æ–‡ä»¶</span></span>
<span class="line"><span style="color:#F8F8F2;">    chars </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> MyTTF.get_chars_from_unicode(</span><span style="color:#FD971F;font-style:italic;">latin</span><span style="color:#F92672;">=</span><span style="color:#AE81FF;">True</span><span style="color:#F8F8F2;">, </span><span style="color:#FD971F;font-style:italic;">chinese_characters</span><span style="color:#F92672;">=</span><span style="color:#AE81FF;">True</span><span style="color:#F8F8F2;">, </span><span style="color:#FD971F;font-style:italic;">chinese_simplified</span><span style="color:#F92672;">=</span><span style="color:#AE81FF;">True</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">    MyTTF.subset(</span><span style="color:#FD971F;font-style:italic;">sfile</span><span style="color:#F92672;">=</span><span style="color:#E6DB74;">&#39;AnimeHug-2.ttf&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#FD971F;font-style:italic;">chars</span><span style="color:#F92672;">=</span><span style="color:#66D9EF;font-style:italic;">set</span><span style="color:#F8F8F2;">(chars))</span></span>
<span class="line"><span style="color:#88846F;">    # åŸºäºå­—ç¬¦ä¸²ç”Ÿæˆå­—ä½“æ–‡ä»¶</span></span>
<span class="line"><span style="color:#88846F;">    # MyTTF.subset(sfile=&#39;AnimeHug-2.ttf&#39;, chars=set(&quot;test&quot;))</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br></div></div>`,5)])])}const u=n(o,[["render",e]]);export{b as __pageData,u as default};
