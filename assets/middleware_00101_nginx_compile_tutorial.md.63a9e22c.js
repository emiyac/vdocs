import{_ as s,o as n,c as a,Q as l}from"./chunks/framework.eabe3503.js";const b=JSON.parse('{"title":"源码构建nginx镜像","description":"","frontmatter":{"title":"源码构建nginx镜像","createTime":"2024/01/26 11:58:07","updateTime":"2024/01/29 20:18:03","isPublished":true,"tags":["nginx"]},"headers":[],"relativePath":"middleware/00101_nginx_compile_tutorial.md","filePath":"middleware/00101_nginx_compile_tutorial.md"}'),p={name:"middleware/00101_nginx_compile_tutorial.md"},e=l(`<div class="tip custom-block"><p class="custom-block-title">TIP</p><p>version: nginx/1.24.0</p></div><h2 id="基于alpine镜像源码构建nginx" tabindex="-1">基于alpine镜像源码构建nginx <a class="header-anchor" href="#基于alpine镜像源码构建nginx" aria-label="Permalink to &quot;基于alpine镜像源码构建nginx&quot;">​</a></h2><p>👉 <a href="https://nginx.org/download/nginx-1.24.0.tar.gz" target="_blank" rel="noreferrer">nginx源码下载地址</a></p><h3 id="nginx-conf" tabindex="-1">nginx.conf <a class="header-anchor" href="#nginx-conf" aria-label="Permalink to &quot;nginx.conf&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">user</span><span style="color:#BABED8;">  </span><span style="color:#C3E88D;">nginx</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#FFCB6B;">worker_processes</span><span style="color:#BABED8;">  </span><span style="color:#C3E88D;">auto</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">error_log</span><span style="color:#BABED8;">  </span><span style="color:#C3E88D;">/var/log/nginx/error.log</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">notice</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#FFCB6B;">pid</span><span style="color:#BABED8;">        </span><span style="color:#C3E88D;">/var/run/nginx.pid</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">events</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">worker_connections</span><span style="color:#BABED8;">  </span><span style="color:#F78C6C;">1024</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">http</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">include</span><span style="color:#BABED8;">       </span><span style="color:#C3E88D;">/etc/nginx/mime.types</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">default_type</span><span style="color:#BABED8;">  </span><span style="color:#C3E88D;">application/octet-stream</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">log_format</span><span style="color:#BABED8;">  </span><span style="color:#C3E88D;">main</span><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">$remote_addr - $remote_user [$time_local] &quot;$request&quot; </span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#BABED8;">                      </span><span style="color:#FFCB6B;">&#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;</span></span>
<span class="line"><span style="color:#BABED8;">                      </span><span style="color:#FFCB6B;">&#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">access_log</span><span style="color:#BABED8;">  </span><span style="color:#C3E88D;">/var/log/nginx/access.log</span><span style="color:#BABED8;">  </span><span style="color:#C3E88D;">main</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">sendfile</span><span style="color:#BABED8;">        </span><span style="color:#C3E88D;">on</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">#tcp_nopush     on;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">keepalive_timeout</span><span style="color:#BABED8;">  </span><span style="color:#F78C6C;">65</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">#gzip  on;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">include</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/etc/nginx/conf.d/</span><span style="color:#BABED8;">*</span><span style="color:#C3E88D;">.conf</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h3 id="default-conf" tabindex="-1">default.conf <a class="header-anchor" href="#default-conf" aria-label="Permalink to &quot;default.conf&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">server</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">listen</span><span style="color:#BABED8;">       </span><span style="color:#F78C6C;">80</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">server_name</span><span style="color:#BABED8;">  </span><span style="color:#C3E88D;">localhost</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">#access_log  /var/log/nginx/host.access.log  main;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">location</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#FFCB6B;">root</span><span style="color:#BABED8;">   </span><span style="color:#C3E88D;">/usr/share/nginx/html</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#FFCB6B;">index</span><span style="color:#BABED8;">  </span><span style="color:#C3E88D;">index.html</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">index.htm</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">#error_page  404              /404.html;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;"># redirect server error pages to the static page /50x.html</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">error_page</span><span style="color:#BABED8;">   </span><span style="color:#F78C6C;">500</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">502</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">503</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">504</span><span style="color:#BABED8;">  </span><span style="color:#C3E88D;">/50x.html</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">location</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">=</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">/50x.html</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#FFCB6B;">root</span><span style="color:#BABED8;">   </span><span style="color:#C3E88D;">/usr/share/nginx/html</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">#location ~ \\.php$ {</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">#    proxy_pass   http://127.0.0.1;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">#}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">#location ~ \\.php$ {</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">#    root           html;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">#    fastcgi_pass   127.0.0.1:9000;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">#    fastcgi_index  index.php;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">#    include        fastcgi_params;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">#}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;"># deny access to .htaccess files, if Apache&#39;s document root</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;"># concurs with nginx&#39;s one</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">#location ~ /\\.ht {</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">#    deny  all;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">#}</span></span>
<span class="line"><span style="color:#BABED8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h3 id="dockerfile" tabindex="-1">dockerfile <a class="header-anchor" href="#dockerfile" aria-label="Permalink to &quot;dockerfile&quot;">​</a></h3><div class="language-dockerfile line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">dockerfile</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#BABED8;"> alpine:latest</span></span>
<span class="line"><span style="color:#F78C6C;">MAINTAINER</span><span style="color:#BABED8;"> NGINX Docker Maintainers emiya</span></span>
<span class="line"><span style="color:#F78C6C;">COPY</span><span style="color:#BABED8;"> nginx-1.24.0 /root/nginx</span></span>
<span class="line"><span style="color:#F78C6C;">RUN</span><span style="color:#BABED8;"> set -x &amp;&amp; \\</span></span>
<span class="line"><span style="color:#BABED8;">    mkdir -p /usr/share/nginx /var/cache/nginx &amp;&amp; \\</span></span>
<span class="line"><span style="color:#BABED8;">    sed -i </span><span style="color:#C3E88D;">&quot;s/dl-cdn.alpinelinux.org/mirrors.aliyun.com/g&quot;</span><span style="color:#BABED8;"> /etc/apk/repositories &amp;&amp; \\</span></span>
<span class="line"><span style="color:#BABED8;">    addgroup -g 101 -S nginx &amp;&amp; \\</span></span>
<span class="line"><span style="color:#BABED8;">    adduser -S -D -H -u 101 -h /var/cache/nginx -s /sbin/nologin -G nginx -g nginx nginx &amp;&amp; \\</span></span>
<span class="line"><span style="color:#BABED8;">    apk update &amp;&amp; \\</span></span>
<span class="line"><span style="color:#BABED8;">    apk upgrade &amp;&amp; \\</span></span>
<span class="line"><span style="color:#BABED8;">    apk add --no-cache --virtual .build-deps gcc g++  make &amp;&amp; \\</span></span>
<span class="line"><span style="color:#BABED8;">    apk add --no-cache libc-dev openssl-dev zlib-dev linux-headers libxslt-dev gd-dev geoip-dev perl-dev libedit-dev pcre2-dev &amp;&amp; \\</span></span>
<span class="line"><span style="color:#BABED8;">    cd /root/nginx &amp;&amp; \\</span></span>
<span class="line"><span style="color:#BABED8;">    ./configure --prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --user=nginx --group=nginx --modules-path=/usr/lib/nginx/modules --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/run/nginx.lock --http-client-body-temp-path=/var/cache/nginx/client_temp --http-proxy-temp-path=/var/cache/nginx/proxy_temp --http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp --http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp --http-scgi-temp-path=/var/cache/nginx/scgi_temp --with-compat --with-threads --with-http_addition_module --with-http_auth_request_module --with-http_perl_module --with-http_dav_module --with-http_flv_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_mp4_module --with-http_random_index_module --with-http_realip_module --with-http_secure_link_module --with-http_slice_module --with-http_ssl_module --with-http_stub_status_module --with-http_sub_module --with-http_v2_module --with-mail --with-mail_ssl_module --with-stream --with-stream_realip_module --with-stream_ssl_module --with-stream_ssl_preread_module &amp;&amp; \\</span></span>
<span class="line"><span style="color:#BABED8;">    make &amp;&amp; \\</span></span>
<span class="line"><span style="color:#BABED8;">    make install &amp;&amp; \\</span></span>
<span class="line"><span style="color:#BABED8;">    mv /etc/nginx/html /usr/share/nginx/html &amp;&amp; \\</span></span>
<span class="line"><span style="color:#BABED8;">    apk del --no-network .build-deps &amp;&amp; \\</span></span>
<span class="line"><span style="color:#BABED8;">    ln -sf /dev/stdout /var/log/nginx/access.log &amp;&amp; \\</span></span>
<span class="line"><span style="color:#BABED8;">    ln -sf /dev/stderr /var/log/nginx/error.log &amp;&amp; \\</span></span>
<span class="line"><span style="color:#BABED8;">    rm -rf /root/nginx</span></span>
<span class="line"><span style="color:#F78C6C;">COPY</span><span style="color:#BABED8;"> nginx.conf /etc/nginx/nginx.conf</span></span>
<span class="line"><span style="color:#F78C6C;">COPY</span><span style="color:#BABED8;"> default.conf /etc/nginx/conf.d/default.conf</span></span>
<span class="line"><span style="color:#F78C6C;">EXPOSE</span><span style="color:#BABED8;"> 80 443</span></span>
<span class="line"><span style="color:#F78C6C;">STOPSIGNAL</span><span style="color:#BABED8;"> SIGQUIT</span></span>
<span class="line"><span style="color:#F78C6C;">WORKDIR</span><span style="color:#BABED8;"> /etc/nginx</span></span>
<span class="line"><span style="color:#F78C6C;">ENTRYPOINT</span><span style="color:#BABED8;"> [</span><span style="color:#C3E88D;">&quot;nginx&quot;</span><span style="color:#BABED8;">, </span><span style="color:#C3E88D;">&quot;-g&quot;</span><span style="color:#BABED8;">, </span><span style="color:#C3E88D;">&quot;daemon off;&quot;</span><span style="color:#BABED8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h2 id="安全加固" tabindex="-1">安全加固 <a class="header-anchor" href="#安全加固" aria-label="Permalink to &quot;安全加固&quot;">​</a></h2><p>有时需要隐藏服务器信息用于安全加固</p><h3 id="修改nginx响应头server信息" tabindex="-1">修改nginx响应头server信息 <a class="header-anchor" href="#修改nginx响应头server信息" aria-label="Permalink to &quot;修改nginx响应头server信息&quot;">​</a></h3><p>编辑文件: <code>./nginx-1.24.0/src/http/ngx_http_header_filter_module.c</code></p><div class="language-c line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">static</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">u_char</span><span style="color:#BABED8;"> ngx_http_server_string</span><span style="color:#C792EA;">[]</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Server: unknown</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> CRLF</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">static</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">u_char</span><span style="color:#BABED8;"> ngx_http_server_full_string</span><span style="color:#C792EA;">[]</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Server: unknown</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> CRLF</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">static</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">u_char</span><span style="color:#BABED8;"> ngx_http_server_build_string</span><span style="color:#C792EA;">[]</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Server: unknown</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> CRLF</span><span style="color:#89DDFF;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="修改默认页面的server信息" tabindex="-1">修改默认页面的server信息 <a class="header-anchor" href="#修改默认页面的server信息" aria-label="Permalink to &quot;修改默认页面的server信息&quot;">​</a></h3><p>编辑文件: <code>./nginx-1.24.0/src/http/ngx_http_special_response.c</code></p><div class="language-c line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">static</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">u_char</span><span style="color:#BABED8;"> ngx_http_error_full_tail</span><span style="color:#C792EA;">[]</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;hr&gt;&lt;center&gt;unknown&lt;/center&gt;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> CRLF</span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;/body&gt;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> CRLF</span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;/html&gt;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> CRLF</span></span>
<span class="line"><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">static</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">u_char</span><span style="color:#BABED8;"> ngx_http_error_build_tail</span><span style="color:#C792EA;">[]</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;hr&gt;&lt;center&gt;unknown&lt;/center&gt;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> CRLF</span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;/body&gt;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> CRLF</span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;/html&gt;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> CRLF</span></span>
<span class="line"><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">static</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">u_char</span><span style="color:#BABED8;"> ngx_http_error_tail</span><span style="color:#C792EA;">[]</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;hr&gt;&lt;center&gt;unknown&lt;/center&gt;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> CRLF</span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;/body&gt;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> CRLF</span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;/html&gt;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> CRLF</span></span>
<span class="line"><span style="color:#89DDFF;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div>`,17),o=[e];function r(t,c,i,y,B,u){return n(),a("div",null,o)}const m=s(p,[["render",r]]);export{b as __pageData,m as default};
